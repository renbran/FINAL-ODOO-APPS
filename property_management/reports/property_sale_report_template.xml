<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- PDF report action for Property Sale -->
    <record id="action_report_property_sale" model="ir.actions.report">
        <field name="name">Property Sale Report</field>
        <field name="model">property.sale</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">property_sale_management.property_sale_report_template</field>
        <field name="report_file">property_sale_management.property_sale_report_template</field>
        <field name="binding_model_id" ref="model_property_sale"/>
        <field name="binding_type">report</field>
    </record>
    <template id="property_sale_report_template">
        <t t-call="web.html_container">
            <t t-call="web.external_layout">
                <div class="page">
                    <!-- Header Section -->
                    <div class="row mb-4">
                        <div class="col-6">
                            <h2><t t-esc="data['SaleName']"/></h2>
                            <p>Reference: <t t-esc="data['SaleReference']"/></p>
                        </div>
                        <div class="col-6 text-right">
                            <img t-if="company.logo" t-att-src="image_data_uri(company.logo)" style="max-height: 45px;" alt="Logo"/>
                        </div>
                    </div>

                    <!-- Customer Information -->
                    <div class="row mb-4">
                        <div class="col-6">
                            <strong>Customer:</strong>
                            <address>
                                <t t-esc="data['CustomerName']"/><br/>
                                <t t-esc="data['CustomerAddress']"/><br/>
                                <t t-esc="data['CustomerAddress2']"/><br/>
                                <t t-if="data['CustomerContact']">
                                    Phone: <t t-esc="data['CustomerContact']"/>
                                </t>
                            </address>
                        </div>
                        <div class="col-6">
                            <strong>Property:</strong>
                            <p><t t-esc="data['PropertyName']"/></p>
                        </div>
                    </div>

                    <!-- Sale Details -->
                    <div class="row mb-4">
                        <div class="col-12">
                            <table class="table table-sm">
                                <tr>
                                    <th>Sale Price</th>
                                    <td><t t-esc="data['SalePrice']" t-options='{"widget": "monetary", "display_currency": env.company.currency_id}'/></td>
                                </tr>
                                <tr>
                                    <th>Down Payment</th>
                                    <td><t t-esc="data['DownPayment']" t-options='{"widget": "monetary", "display_currency": env.company.currency_id}'/></td>
                                </tr>
                                <tr>
                                    <th>Remaining Balance</th>
                                    <td><t t-esc="data['RemainingBalance']" t-options='{"widget": "monetary", "display_currency": env.company.currency_id}'/></td>
                                </tr>
                                <tr>
                                    <th>DLD Fee</th>
                                    <td><t t-esc="data['DLD_Fee']" t-options='{"widget": "monetary", "display_currency": env.company.currency_id}'/></td>
                                </tr>
                                <tr>
                                    <th>Number of Installments</th>
                                    <td><t t-esc="data['NoOfInstallments']"/></td>
                                </tr>
                                <tr>
                                    <th>Amount Per Installment</th>
                                    <td><t t-esc="data['AmountPerInstallment']" t-options='{"widget": "monetary", "display_currency": env.company.currency_id}'/></td>
                                </tr>
                                <tr>
                                    <th>Start Date</th>
                                    <td><t t-esc="data['StartDate']"/></td>
                                </tr>
                            </table>
                        </div>
                    </div>

                    <!-- Payment Schedule -->
                    <div class="row">
                        <div class="col-12">
                            <h4>Payment Schedule</h4>
                            <table class="table table-sm table-bordered">
                                <thead>
                                    <tr>
                                        <th>Serial No.</th>
                                        <th>Collection Date</th>
                                        <th>Capital Repayment</th>
                                        <th>Remaining Capital</th>
                                        <th>Collection Status</th>
                                        <th>Line Type</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <t t-foreach="docs" t-as="line">
                                        <tr>
                                            <td><t t-esc="line['serial_number']"/></td>
                                            <td><t t-esc="line['collection_date']"/></td>
                                            <td><t t-esc="line['capital_repayment']" t-options='{"widget": "monetary", "display_currency": env.company.currency_id}'/></td>
                                            <td><t t-esc="line['remaining_capital']" t-options='{"widget": "monetary", "display_currency": env.company.currency_id}'/></td>
                                            <td><t t-esc="line['collection_status']"/></td>
                                            <td><t t-esc="line['line_type']"/></td>
                                        </tr>
                                    </t>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </t>
        </t>
    </template>
</odoo>