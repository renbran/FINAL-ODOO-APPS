<?xml version="1.0" encoding="utf-8"?>
<templates>
    <t t-name="dfr_template_new">
        <div class="w-100">
            <!-- Enhanced Header Section -->
            <div class="o_dynamic_accounts_report_header" style="background: white; border-radius: 12px; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1); margin: 1rem; border: 1px solid #e2e8f0;">
                <div class="filter_view_dfr p-4">
                    <!-- Title Section -->
                    <div class="enterprise-title-section mb-4">
                        <h1 class="enterprise-main-title mb-2" style="display: flex; align-items: center; gap: 0.75rem; color: #0f172a; font-weight: 700; font-size: 2rem; margin: 0;">
                            <span style="background: linear-gradient(135deg, #2563eb, #06d6a0); padding: 0.5rem; border-radius: 8px; filter: grayscale(0); font-size: 1.5rem;">ðŸ“ˆ</span>
                            <t t-esc="state.title"/>
                        </h1>
                        <p class="enterprise-subtitle" style="color: #64748b; margin: 0; font-size: 1rem;">
                            Enterprise-level financial reporting with advanced analytics
                        </p>
                    </div>

                    <!-- Controls Section -->
                    <div class="sub_container_right d-flex justify-content-between align-items-center flex-wrap" style="background: #f8fafc; border-radius: 8px; border: 1px solid #e2e8f0; padding: 1rem; gap: 1rem;">
                        <t t-if="state.filter_data">
                            <!-- Export Actions -->
                            <div class="report_print d-flex gap-2">
                                <button type="button"
                                        class="btn btn-report-print"
                                        t-on-click="print_pdf"
                                        title="Export as PDF">
                                    <i class="fa fa-file-pdf-o me-1"></i>
                                    Export PDF
                                </button>
                                <button type="button"
                                        class="btn btn-report-print"
                                        t-on-click="print_xlsx"
                                        title="Export as Excel">
                                    <i class="fa fa-file-excel-o me-1"></i>
                                    Export Excel
                                </button>
                            </div>

                            <!-- Filter Controls -->
                            <div class="filter d-flex gap-3 align-items-center flex-wrap">
                                <!-- Date Range Filter -->
                                <div class="time_range">
                                    <a type="button" class="dropdown-toggle enterprise-filter-btn"
                                       data-bs-toggle="dropdown"
                                       title="Select date range">
                                        <i class="fa fa-calendar me-2"></i>
                                        Date Range
                                        <i class="fa fa-chevron-down ms-2"></i>
                                    </a>
                                    <div class="dropdown-menu enterprise-dropdown" role="menu">
                                        <div class="dropdown-header">
                                            <strong>Quick Filters</strong>
                                        </div>
                                        <button class="report-filter-button"
                                                t-att-data-value="'month'"
                                                type="button"
                                                t-on-click="apply_date">
                                            <i class="fa fa-calendar-o me-2"></i>This Month
                                        </button>
                                        <button class="report-filter-button"
                                                t-att-data-value="'quarter'"
                                                type="button"
                                                t-on-click="apply_date">
                                            <i class="fa fa-calendar me-2"></i>This Quarter
                                        </button>
                                        <button class="report-filter-button"
                                                t-att-data-value="'year'"
                                                type="button"
                                                t-on-click="apply_date">
                                            <i class="fa fa-calendar-plus-o me-2"></i>This Year
                                        </button>
                                        <div class="dropdown-divider"></div>
                                        <button class="report-filter-button"
                                                t-att-data-value="'last-month'"
                                                type="button"
                                                t-on-click="apply_date">
                                            <i class="fa fa-calendar-minus-o me-2"></i>Last Month
                                        </button>
                                        <button class="report-filter-button"
                                                t-att-data-value="'last-quarter'"
                                                type="button"
                                                t-on-click="apply_date">
                                            <i class="fa fa-calendar-minus-o me-2"></i>Last Quarter
                                        </button>
                                        <button class="report-filter-button"
                                                t-att-data-value="'last-year'"
                                                type="button"
                                                t-on-click="apply_date">
                                            <i class="fa fa-calendar-minus-o me-2"></i>Last Year
                                        </button>
                                        <div class="dropdown-divider"></div>
                                        <div class="p-3">
                                            <label class="form-label" for="date_from">
                                                <strong>Custom Range</strong>
                                            </label>
                                            <div class="mb-2">
                                                <label class="form-label-sm" for="start_date">Start Date:</label>
                                                <input type="date"
                                                       id="start_date"
                                                       t-on-change="apply_date"
                                                       class="form-control form-control-sm"
                                                       name="start_date"/>
                                            </div>
                                            <div class="mb-2">
                                                <label class="form-label-sm" for="end_date">End Date:</label>
                                                <input type="date"
                                                       id="end_date"
                                                       t-on-change="apply_date"
                                                       class="form-control form-control-sm"
                                                       name="end_date"/>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                                 t-ref="date_to"
                                                 data-target-input="nearest">
                                                <input type="date"
                                                       id="end_date"
                                                       t-on-change="apply_date"
                                                       style="border:none;border-bottom: 1px solid #000;padding: 5px;outline: none;"
                                                       name="end_date"/>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- Comparison Filter -->
                                <div class="comparison_range">
                                    <a type="button" class="dropdown-toggle enterprise-filter-btn"
                                       data-bs-toggle="dropdown"
                                       title="Compare with previous periods">
                                        <i class="fa fa-line-chart me-2"></i>
                                        Comparison
                                        <i class="fa fa-chevron-down ms-2"></i>
                                    </a>
                                    <div class="dropdown-menu enterprise-dropdown" role="menu">
                                        <div class="dropdown-header">
                                            <strong>Comparison Options</strong>
                                        </div>
                                        <button class="report-filter-button"
                                                t-att-data-value="'no comparison'"
                                                type="button"
                                                t-on-click="apply_comparison">
                                            <i class="fa fa-ban me-2"></i>No Comparison
                                        </button>
                                        <div class="dropdown-divider"></div>
                                        
                                        <div class="p-3">
                                            <div class="mb-3">
                                                <label class="form-label">
                                                    <i class="fa fa-history me-2"></i><strong>Previous Period</strong>
                                                </label>
                                                <p class="text-muted small mb-2">Compare with previous months/quarters</p>
                                                <div class="input-group mb-2">
                                                    <span class="input-group-text">Periods:</span>
                                                    <input type="number"
                                                           t-ref="periods"
                                                           min="1"
                                                           max="12"
                                                           t-on-input="onPeriodChange"
                                                           class="form-control"
                                                           placeholder="1"
                                                           name="previous_period"/>
                                                </div>
                                                <button class="btn btn-primary btn-sm w-100"
                                                        type="button"
                                                        t-on-click="applyComparisonPeriod">
                                                    <i class="fa fa-check me-1"></i>Apply Period Comparison
                                                </button>
                                            </div>
                                            
                                            <div class="mb-3">
                                                <label class="form-label">
                                                    <i class="fa fa-calendar me-2"></i><strong>Same Period Last Year</strong>
                                                </label>
                                                <p class="text-muted small mb-2">Compare with same period in previous years</p>
                                                <div class="input-group mb-2">
                                                    <span class="input-group-text">Years:</span>
                                                    <input type="number"
                                                           t-ref="period_year"
                                                           t-on-input="onPeriodYearChange"
                                                           min="1"
                                                           max="5"
                                                           class="form-control"
                                                           placeholder="1"
                                                           name="period_year"/>
                                                </div>
                                                <button class="btn btn-primary btn-sm w-100"
                                                        type="button"
                                                        t-on-click="applyComparisonYear">
                                                    <i class="fa fa-check me-1"></i>Apply Year Comparison
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Journal Filter -->
                                <div class="journals_filter dropdown">
                                    <a type="button" class="dropdown-toggle enterprise-filter-btn"
                                       data-bs-toggle="dropdown"
                                       title="Filter by journals">
                                        <i class="fa fa-book me-2"></i>
                                        Journals
                                        <span class="code badge bg-secondary ms-1" style="display: none;"></span>
                                        <i class="fa fa-chevron-down ms-2"></i>
                                    </a>
                                    <div class="dropdown-menu enterprise-dropdown journals" style="min-width: 280px;">
                                        <div class="dropdown-header d-flex justify-content-between align-items-center">
                                            <strong>Select Journals</strong>
                                            <button type="button" class="btn btn-link btn-sm p-0" t-on-click="clearJournalFilters">
                                                <i class="fa fa-refresh"></i> Clear All
                                            </button>
                                        </div>
                                        <div class="dropdown-divider"></div>
                                        <div class="journal-list" style="max-height: 250px; overflow-y: auto;">
                                            <t t-foreach="state.filter_data['journal']" t-as="journal" t-key="journal_index">
                                                <div class="dropdown-item journal-item d-flex align-items-center" 
                                                     role="menuitem"
                                                     t-on-click="apply_journal"
                                                     style="cursor: pointer; padding: 0.5rem 1rem;">
                                                    <input type="checkbox" 
                                                           class="form-check-input me-3"
                                                           t-att-id="'journal_' + journal.id"
                                                           style="pointer-events: none;"/>
                                                    <div class="flex-grow-1">
                                                        <div class="fw-medium" t-esc="journal.name"></div>
                                                        <small class="text-muted" t-esc="journal.code"></small>
                                                    </div>
                                                    <span t-esc="journal.id" class="d-none"/>
                                                </div>
                                            </t>
                                        </div>
                                    </div>
                                </div>
                                <!-- Accounts Filter -->
                                <div class="accounts_filter dropdown">
                                    <a type="button" class="dropdown-toggle enterprise-filter-btn"
                                       data-bs-toggle="dropdown"
                                       title="Filter by accounts">
                                        <i class="fa fa-list-alt me-2"></i>
                                        Accounts
                                        <span class="code badge bg-secondary ms-1" style="display: none;"></span>
                                        <i class="fa fa-chevron-down ms-2"></i>
                                    </a>
                                    <div class="dropdown-menu enterprise-dropdown accounts" style="min-width: 300px;">
                                        <div class="dropdown-header">
                                            <strong>Select Accounts</strong>
                                        </div>
                                        <div class="dropdown-divider"></div>
                                        <div class="accounts-list" style="max-height: 300px; overflow-y: auto;">
                                            <t t-foreach="state.filter_data['account']" t-as="account" t-key="account_index">
                                                <div class="dropdown-item account-item d-flex align-items-center" 
                                                     role="menuitem"
                                                     t-on-click="apply_account"
                                                     style="cursor: pointer; padding: 0.5rem 1rem;">
                                                    <input type="checkbox" 
                                                           class="form-check-input me-3"
                                                           t-att-id="'account_' + account.id"
                                                           style="pointer-events: none;"/>
                                                    <div class="flex-grow-1">
                                                        <div class="fw-medium" t-esc="account.name"></div>
                                                        <small class="text-muted" t-esc="'Code: ' + account.code"></small>
                                                    </div>
                                                    <span t-esc="account.id" class="d-none"/>
                                                </div>
                                            </t>
                                        </div>
                                    </div>
                                </div>
                                <!-- Analytic Accounts Filter -->
                                <div class="analytic_filter dropdown">
                                    <a type="button" class="dropdown-toggle enterprise-filter-btn"
                                       data-bs-toggle="dropdown"
                                       title="Filter by analytic accounts">
                                        <i class="fa fa-folder-open me-2"></i>
                                        Analytic Accounts
                                        <span class="analytic badge bg-secondary ms-1" style="display: none;"></span>
                                        <i class="fa fa-chevron-down ms-2"></i>
                                    </a>
                                    <div class="dropdown-menu enterprise-dropdown analytic_accounts" style="min-width: 280px;">
                                        <div class="dropdown-header">
                                            <strong>Select Analytic Accounts</strong>
                                        </div>
                                        <div class="dropdown-divider"></div>
                                        <div class="analytic-list" style="max-height: 250px; overflow-y: auto;">
                                            <t t-foreach="state.filter_data['analytic']" t-as="analytic" t-key="analytic_index">
                                                <div class="dropdown-item analytic-item d-flex align-items-center" 
                                                     role="menuitem"
                                                     t-on-click="apply_analytic_accounts"
                                                     style="cursor: pointer; padding: 0.5rem 1rem;">
                                                    <input type="checkbox" 
                                                           class="form-check-input me-3"
                                                           t-att-id="'analytic_' + analytic.id"
                                                           style="pointer-events: none;"/>
                                                    <div class="flex-grow-1">
                                                        <div class="fw-medium" t-esc="analytic.name"></div>
                                                        <small class="text-muted" t-esc="'ID: ' + analytic.id"></small>
                                                    </div>
                                                    <span t-esc="analytic.id" class="d-none"/>
                                                </div>
                                            </t>
                                        </div>
                                    </div>
                                </div>
                                <!-- Target Move Filter -->
                                <div class="search_Target_move dropdown">
                                    <a type="button" class="dropdown-toggle enterprise-filter-btn"
                                       data-bs-toggle="dropdown"
                                       title="Filter by journal entry status">
                                        <i class="fa fa-filter me-2"></i>
                                        Target Move
                                        <span class="target badge bg-secondary ms-1" style="display: none;"></span>
                                        <i class="fa fa-chevron-down ms-2"></i>
                                    </a>
                                    <div class="dropdown-menu enterprise-dropdown" role="menu">
                                        <div class="dropdown-header">
                                            <strong>Entry Status</strong>
                                        </div>
                                        <div class="dropdown-divider"></div>
                                        <div class="p-2">
                                            <button class="report-filter-button btn btn-outline-primary w-100 mb-2"
                                                    t-attf-value="posted"
                                                    t-ref="posted"
                                                    type="button"
                                                    t-on-click="apply_entries">
                                                <i class="fa fa-check-circle me-2"></i>Posted Entries
                                            </button>
                                            <button class="report-filter-button btn btn-outline-secondary w-100 mb-2"
                                                    t-attf-value="draft"
                                                    t-ref="draft"
                                                    type="button"
                                                    t-on-click="apply_entries">
                                                <i class="fa fa-edit me-2"></i>Include Draft Entries
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <!-- Action Buttons -->
                                <div class="action-buttons d-flex gap-2">
                                    <button class="btn btn-enterprise-secondary"
                                            type="button"
                                            t-ref="unfoldButton"
                                            t-on-click="unfoldAll"
                                            title="Expand all sections">
                                        <i class="fa fa-expand me-1"></i>Unfold All
                                    </button>
                                    <button class="btn btn-enterprise-secondary"
                                            type="button"
                                            t-ref="foldButton"
                                            t-on-click="foldAll"
                                            title="Collapse all sections">
                                        <i class="fa fa-compress me-1"></i>Fold All
                                    </button>
                                    <button class="btn btn-enterprise-primary"
                                            type="button"
                                            t-on-click="apply_filter"
                                            title="Apply all filters">
                                        <i class="fa fa-search me-1"></i>Apply Filters
                                    </button>
                                </div>
                            </div>
                        </t>
                    </div>
                </div>
            </div>
            <br/>
            <!-- Report Table Section -->
            <div class="enterprise-table-container">
                <div class="table_view_dfr enterprise-table-wrapper">
                    <div class="enterprise-table-content">
                        <div class="table_main_view">
                            <table class="enterprise-table" cellspacing="0" width="100%">
                                <thead class="enterprise-table-header">
                                    <tr class="o_heading enterprise-header-row">
                                        <th class="enterprise-header-cell period-header" colspan="6">
                                            <div class="header-content">
                                                <i class="fa fa-calendar me-2"></i>
                                                <span class="header-title">Accounting Periods</span>
                                            </div>
                                        </th>
                                        <t t-if="state.year">
                                            <t t-foreach="state.year"
                                               t-as="periodData"
                                               t-key="periodData_index">
                                                <th class="enterprise-header-cell text-end period-data">
                                                    <div class="period-badge">
                                                        <t t-esc="periodData"/>
                                                    </div>
                                                </th>
                                            </t>
                                        </t>
                                    </tr>
                                    <tr class="o_heading enterprise-subheader-row">
                                        <th class="enterprise-header-cell" colspan="6">
                                            <div class="header-content">
                                                <i class="fa fa-list me-2"></i>
                                                <span class="header-title">Account Details</span>
                                            </div>
                                        </th>
                                        <t t-if="state.year">
                                            <t t-foreach="state.year"
                                               t-as="periodData"
                                               t-key="periodData_index">
                                                <th class="enterprise-header-cell text-end balance-header">
                                                    <div class="balance-label">
                                                        <i class="fa fa-calculator me-1"></i>Balance
                                                    </div>
                                                </th>
                                            </t>
                                        </t>
                                    </tr>
                                </thead>
                                <tbody class="enterprise-table-body" t-ref="tbody">
                                    <t t-if="state.datas">
                                        <tr class="gl-line">
                                            <th colspan="6">
                                                <span class="fw-bolder">
                                                    Net Profit
                                                </span>
                                            </th>
                                            <t t-foreach="state.datas"
                                               t-as="total"
                                               t-key="total_index">
                                                <th class="text-end">
                                                    <span class="fw-bolder">
                                                        <t t-if="total.total"
                                                           t-esc="total.total.toFixed(2)"/>
                                                    </span>
                                                </th>
                                            </t>
                                        </tr>
                                        <tr class="border-bottom border-dark">
                                            <th colspan="6">
                                                <span class="fw-bolder ms-2">
                                                    Income
                                                </span>
                                            </th>
                                            <t t-foreach="state.datas"
                                               t-as="total_income"
                                               t-key="total_income_index">
                                                <th class="text-end">
                                                    <span class="fw-bolder">
                                                        <t t-esc="total_income.total_income"/>
                                                    </span>
                                                </th>
                                            </t>
                                        </tr>
                                        <tr class="border-bottom border-gainsboro">
                                            <th colspan="6">
                                                <span class="fw-bolder ms-3">
                                                    Gross Profit
                                                </span>
                                            </th>
                                            <t t-foreach="state.datas"
                                                   t-as="value"
                                                   t-key="value_index">
                                                    <th class="text-end">
                                                        <span>
                                                            <t t-esc="sumGrossProfit(value.expense_direct_cost[1], value.income[1]).toFixed(2)"/>
                                                        </span>
                                                    </th>
                                                </t>
                                        </tr>
                                        <t t-foreach="state.datas" t-as="value"
                                           t-key="value_index">
                                            <t t-if="value.income[1] != '0.00'">
                                                <t t-set="income" t-value="1"/>
                                            </t>
                                        </t>
                                        <t t-if="income == 1">
                                            <tr class="border-bottom border-gainsboro">
                                                <th colspan="6">
                                                    <div data-bs-toggle="collapse"
                                                         href="#collapseIncome"
                                                         aria-expanded="false"
                                                         aria-controls="collapseIncome"
                                                         class="ms-3 collapsed">
                                                        <a class="btn header">
                                                            <span class="toggle-icon">
                                                                <i class="fa fa-caret-down"/>
                                                            </span>
                                                            <span class="ms-3">
                                                                Operating
                                                                Income
                                                            </span>
                                                        </a>
                                                    </div>
                                                </th>
                                                <t t-foreach="state.datas"
                                                   t-as="value"
                                                   t-key="value_index">
                                                    <th class="text-end">
                                                        <span>
                                                            <t t-esc="value.income[1]"/>
                                                        </span>
                                                    </th>
                                                </t>
                                            </tr>
                                            <t t-foreach="state.datas"
                                               t-as="value"
                                               t-key="value_index">
                                                <t t-if="value_index == 0">
                                                    <t t-foreach="value.income[0]"
                                                       t-as="income"
                                                       t-key="income_index">
                                                        <t t-set="income_name"
                                                           t-value="income.name"/>
                                                        <t t-set="account_value"
                                                           t-value="0"/>
                                                        <t t-foreach="state.datas"
                                                           t-as="values"
                                                           t-key="values_index">
                                                            <t t-foreach="values.income[0]"
                                                               t-as="income"
                                                               t-key="income_index">
                                                                <t t-if="income_name == income.name">
                                                                    <t t-if="income.amount != '0.00'">
                                                                        <t t-set="account_value"
                                                                           t-value="1"/>
                                                                    </t>
                                                                </t>
                                                            </t>
                                                        </t>
                                                        <t t-if="account_value == 1">
                                                            <tr class="border-bottom border-gainsboro collapse"
                                                                id="collapseIncome">
                                                                <th colspan="6">
                                                                    <span class="dropdown">
                                                                        <a class="dropdown-toggle"
                                                                           data-bs-toggle="dropdown">
                                                                            <span class="ms-5">
                                                                                <t t-esc="income.name"/>
                                                                            </span>
                                                                        </a>
                                                                        <span class="dropdown-menu">
                                                                            <a role="menuitem"
                                                                               t-on-click="show_gl"
                                                                               class="show_gl">
                                                                                General
                                                                                Ledger
                                                                            </a>
                                                                        </span>
                                                                    </span>
                                                                </th>
                                                                <t t-foreach="state.datas"
                                                                   t-as="values"
                                                                   t-key="values_index">
                                                                    <t t-foreach="values.income[0]"
                                                                       t-as="income"
                                                                       t-key="income_index">
                                                                        <t t-if="income_name == income.name">
                                                                            <th class="text-end">
                                                                                <span>
                                                                                    <t t-esc="income.amount"/>
                                                                                </span>
                                                                            </th>
                                                                        </t>
                                                                    </t>
                                                                </t>
                                                            </tr>
                                                        </t>
                                                    </t>
                                                </t>
                                            </t>
                                        </t>
                                        <t t-else="">
                                            <tr class="border-bottom border-gainsboro">
                                                <th colspan="9">
                                                    <span class="ms-4">
                                                        Operating
                                                        Income
                                                    </span>
                                                </th>
                                            </tr>
                                        </t>
                                        <t t-foreach="state.datas" t-as="value"
                                           t-key="value_index">
                                            <t t-if="value.expense_direct_cost[1] != '0.00'">
                                                <t t-set="expense_direct_cost"
                                                   t-value="1"/>
                                            </t>
                                        </t>
                                        <t t-if="expense_direct_cost  == 1">
                                            <tr class="border-bottom border-gainsboro">
                                                <th colspan="6">
                                                    <div data-bs-toggle="collapse"
                                                         href="#collapseRevenue"
                                                         aria-expanded="false"
                                                         aria-controls="collapseRevenue"
                                                         class="ms-3 collapsed">
                                                        <a class="btn header">
                                                            <span class="toggle-icon">
                                                                <i class="fa fa-caret-down"/>
                                                            </span>
                                                            <span class="ms-3">
                                                                Cost
                                                                of
                                                                Revenue
                                                            </span>
                                                        </a>
                                                    </div>
                                                </th>
                                                <t t-foreach="state.datas"
                                                   t-as="value"
                                                   t-key="value_index">
                                                    <th class="text-end">
                                                        <span>
                                                            <t t-esc="value.expense_direct_cost[1]"/>
                                                        </span>
                                                    </th>
                                                </t>
                                            </tr>
                                            <t t-foreach="state.datas"
                                               t-as="value"
                                               t-key="value_index">
                                                <t t-if="value_index == 0">
                                                    <t t-foreach="value.expense_direct_cost[0]"
                                                       t-as="income"
                                                       t-key="income_index">
                                                        <t t-set="income_name"
                                                           t-value="income.name"/>
                                                        <t t-set="account_value"
                                                           t-value="0"/>
                                                        <t t-foreach="state.datas"
                                                           t-as="values"
                                                           t-key="values_index">
                                                            <t t-foreach="values.expense_direct_cost[0]"
                                                               t-as="income"
                                                               t-key="income_index">
                                                                <t t-if="income_name == income.name">
                                                                    <t t-if="income.amount != '0.00'">
                                                                        <t t-set="account_value"
                                                                           t-value="1"/>
                                                                    </t>
                                                                </t>
                                                            </t>
                                                        </t>
                                                        <t t-if="account_value == 1">
                                                            <tr class="border-bottom border-gainsboro collapse"
                                                                id="collapseRevenue">
                                                                <th colspan="6">
                                                                    <span class="dropdown">
                                                                        <a class="dropdown-toggle"
                                                                           data-bs-toggle="dropdown">
                                                                            <span class="ms-5">
                                                                                <t t-esc="income.name"/>
                                                                            </span>
                                                                        </a>
                                                                        <span class="dropdown-menu">
                                                                            <a role="menuitem"
                                                                               t-on-click="show_gl"
                                                                               class="show_gl">
                                                                                General
                                                                                Ledger
                                                                            </a>
                                                                        </span>
                                                                    </span>
                                                                </th>
                                                                <t t-foreach="state.datas"
                                                                   t-as="values"
                                                                   t-key="values_index">
                                                                    <t t-foreach="values.expense_direct_cost[0]"
                                                                       t-as="income"
                                                                       t-key="income_index">
                                                                        <t t-if="income_name == income.name">
                                                                            <th class="text-end">
                                                                                <span>
                                                                                    <t t-esc="income.amount"/>
                                                                                </span>
                                                                            </th>
                                                                        </t>
                                                                    </t>
                                                                </t>
                                                            </tr>
                                                        </t>
                                                    </t>
                                                </t>
                                            </t>
                                        </t>
                                        <t t-else="">
                                            <tr class="border-bottom border-gainsboro">
                                                <th colspan="9">
                                                    <span class="ms-4">Cost of
                                                        Revenue
                                                    </span>
                                                </th>
                                            </tr>
                                        </t>
                                        <t t-foreach="state.datas" t-as="value"
                                           t-key="value_index">
                                            <t t-if="value.income_other[1] != '0.00'">
                                                <t t-set="income_other"
                                                   t-value="1"/>
                                            </t>
                                        </t>
                                        <t t-if="income_other  == 1">
                                            <tr class="border-bottom border-gainsboro">
                                                <th colspan="6">
                                                    <div data-bs-toggle="collapse"
                                                         href="#collapseOtherIncome"
                                                         aria-expanded="false"
                                                         aria-controls="collapseOtherIncome"
                                                         class="ms-1 collapsed">
                                                        <a class="btn header">
                                                            <span class="toggle-icon">
                                                                <i class="fa fa-caret-down"/>
                                                            </span>
                                                            <span class="ms-3">
                                                                Other Income
                                                            </span>
                                                        </a>
                                                    </div>
                                                </th>
                                                <t t-foreach="state.datas"
                                                   t-as="value"
                                                   t-key="value_index">
                                                    <th class="text-end">
                                                        <span>
                                                            <t t-esc="value.income_other[1]"/>
                                                        </span>
                                                    </th>
                                                </t>
                                            </tr>
                                            <t t-foreach="state.datas"
                                               t-as="value"
                                               t-key="value_index">
                                                <t t-if="value_index == 0">
                                                    <t t-foreach="value.income_other[0]"
                                                       t-as="income"
                                                       t-key="income_index">
                                                        <t t-set="income_name"
                                                           t-value="income.name"/>
                                                        <t t-set="account_value"
                                                           t-value="0"/>
                                                        <t t-foreach="state.datas"
                                                           t-as="values"
                                                           t-key="values_index">
                                                            <t t-foreach="values.income_other[0]"
                                                               t-as="income"
                                                               t-key="income_index">
                                                                <t t-if="income_name == income.name">
                                                                    <t t-if="income.amount != '0.00'">
                                                                        <t t-set="account_value"
                                                                           t-value="1"/>
                                                                    </t>
                                                                </t>
                                                            </t>
                                                        </t>
                                                        <t t-if="account_value == 1">
                                                            <tr class="border-bottom border-gainsboro collapse"
                                                                id="collapseOtherIncome">
                                                                <th colspan="6">
                                                                    <span class="dropdown">
                                                                        <a class="dropdown-toggle"
                                                                           data-bs-toggle="dropdown">
                                                                            <span class="ms-4">
                                                                                <t t-esc="income.name"/>
                                                                            </span>
                                                                        </a>
                                                                        <span class="dropdown-menu">
                                                                            <a role="menuitem"
                                                                               t-on-click="show_gl"
                                                                               class="show_gl">
                                                                                General
                                                                                Ledger
                                                                            </a>
                                                                        </span>
                                                                    </span>
                                                                </th>
                                                                <t t-foreach="state.datas"
                                                                   t-as="values"
                                                                   t-key="values_index">
                                                                    <t t-foreach="values.income_other[0]"
                                                                       t-as="income"
                                                                       t-key="income_index">
                                                                        <t t-if="income_name == income.name">
                                                                            <th class="text-end">
                                                                                <span>
                                                                                    <t t-esc="income.amount"/>
                                                                                </span>
                                                                            </th>
                                                                        </t>
                                                                    </t>
                                                                </t>
                                                            </tr>
                                                        </t>
                                                    </t>
                                                </t>
                                            </t>
                                        </t>
                                        <t t-else="">
                                            <tr class="border-bottom border-gainsboro">
                                                <th colspan="9">
                                                    <span class="ms-3">Other
                                                        Income
                                                    </span>
                                                </th>
                                            </tr>
                                        </t>
                                        <tr class="border-bottom border-gainsboro">
                                            <th colspan="6">
                                                <span class="fw-bolder ms-2">
                                                    Total Income
                                                </span>
                                            </th>
                                            <t t-foreach="state.datas"
                                               t-as="total_income"
                                               t-key="total_income_index">
                                                <th class="text-end">
                                                    <span class="fw-bolder">
                                                        <t t-esc="total_income.total_income"/>
                                                    </span>
                                                </th>
                                            </t>
                                        </tr>
                                        <tr class="border-bottom border-dark">
                                            <th colspan="6">
                                                <span class="fw-bolder ms-1">
                                                    Expenses
                                                </span>
                                            </th>
                                            <t t-foreach="state.datas"
                                               t-as="total_expense"
                                               t-key="total_expense_index">
                                                <th class="text-end">
                                                    <span class="fw-bolder">
                                                        <t t-esc="total_expense.total_expense"/>
                                                    </span>
                                                </th>
                                            </t>
                                        </tr>
                                        <t t-foreach="state.datas" t-as="value"
                                           t-key="value_index">
                                            <t t-if="value.expense[1] != '0.00'">
                                                <t t-set="expense"
                                                   t-value="1"/>
                                            </t>
                                        </t>
                                        <t t-if="expense  == 1">
                                            <tr class="border-bottom border-gainsboro">
                                                <th colspan="6">
                                                    <div data-bs-toggle="collapse"
                                                         href="#collapseExpenses"
                                                         aria-expanded="false"
                                                         aria-controls="collapseExpenses"
                                                         class="ms-2 collapsed">
                                                        <a class="btn header">
                                                            <span class="toggle-icon">
                                                                <i class="fa fa-caret-down"/>
                                                            </span>
                                                            <span class="ms-3">
                                                                Expenses
                                                            </span>
                                                        </a>
                                                    </div>
                                                </th>
                                                <t t-foreach="state.datas"
                                                   t-as="value"
                                                   t-key="value_index">
                                                    <th class="text-end">
                                                        <span>
                                                            <t t-esc="value.expense[1]"/>
                                                        </span>
                                                    </th>
                                                </t>
                                            </tr>
                                            <t t-foreach="state.datas"
                                               t-as="value"
                                               t-key="value_index">
                                                <t t-if="value_index == 0">
                                                    <t t-foreach="value.expense[0]"
                                                       t-as="income"
                                                       t-key="income_index">
                                                        <t t-set="income_name"
                                                           t-value="income.name"/>
                                                        <t t-set="account_value"
                                                           t-value="0"/>
                                                        <t t-foreach="state.datas"
                                                           t-as="values"
                                                           t-key="values_index">
                                                            <t t-foreach="values.expense[0]"
                                                               t-as="income"
                                                               t-key="income_index">
                                                                <t t-if="income_name == income.name">
                                                                    <t t-if="income.amount != '0.00'">
                                                                        <t t-set="account_value"
                                                                           t-value="1"/>
                                                                    </t>
                                                                </t>
                                                            </t>
                                                        </t>
                                                        <t t-if="account_value == 1">
                                                            <tr class="border-bottom border-gainsboro collapse"
                                                                id="collapseExpenses">
                                                                <th colspan="6">
                                                                    <span class="dropdown">
                                                                        <a class="dropdown-toggle"
                                                                           data-bs-toggle="dropdown">
                                                                            <span class="ms-5">
                                                                                <t t-esc="income.name"/>
                                                                            </span>
                                                                        </a>
                                                                        <span class="dropdown-menu">
                                                                            <a role="menuitem"
                                                                               t-on-click="show_gl"
                                                                               class="show_gl">
                                                                                General
                                                                                Ledger
                                                                            </a>
                                                                        </span>
                                                                    </span>
                                                                </th>
                                                                <t t-foreach="state.datas"
                                                                   t-as="values"
                                                                   t-key="values_index">
                                                                    <t t-foreach="values.expense[0]"
                                                                       t-as="income"
                                                                       t-key="income_index">
                                                                        <t t-if="income_name == income.name">
                                                                            <th class="text-end">
                                                                                <span>
                                                                                    <t t-esc="income.amount"/>
                                                                                </span>
                                                                            </th>
                                                                        </t>
                                                                    </t>
                                                                </t>
                                                            </tr>
                                                        </t>
                                                    </t>
                                                </t>
                                            </t>
                                        </t>
                                        <t t-else="">
                                            <tr class="border-bottom border-gainsboro">
                                                <th colspan="9">
                                                    <span class="ms-2">Expenses
                                                    </span>
                                                </th>
                                            </tr>
                                        </t>
                                        <t t-foreach="state.datas" t-as="value"
                                           t-key="value_index">
                                            <t t-if="value.expense_depreciation[1] != '0.00'">
                                                <t t-set="expense_depreciation"
                                                   t-value="1"/>
                                            </t>
                                        </t>
                                        <t t-if="expense_depreciation  == 1">
                                            <tr class="border-bottom border-gainsboro">
                                                <th colspan="6">
                                                    <div data-bs-toggle="collapse"
                                                         href="#collapseDepreciation"
                                                         aria-expanded="false"
                                                         aria-controls="collapseDepreciation"
                                                         class="ms-2 collapsed">
                                                        <a class="btn header">
                                                            <span class="toggle-icon">
                                                                <i class="fa fa-caret-down"/>
                                                            </span>
                                                            <span class="ms-3">
                                                                Depreciation
                                                            </span>
                                                        </a>
                                                    </div>
                                                </th>
                                                <t t-foreach="state.datas"
                                                   t-as="value"
                                                   t-key="value_index">
                                                    <th class="text-end">
                                                        <span>
                                                            <t t-esc="value.expense_depreciation[1]"/>
                                                        </span>
                                                    </th>
                                                </t>
                                            </tr>
                                            <t t-foreach="state.datas"
                                               t-as="value"
                                               t-key="value_index">
                                                <t t-if="value_index == 0">
                                                    <t t-foreach="value.expense_depreciation[0]"
                                                       t-as="income"
                                                       t-key="income_index">
                                                        <t t-set="income_name"
                                                           t-value="income.name"/>
                                                        <t t-set="account_value"
                                                           t-value="0"/>
                                                        <t t-foreach="state.datas"
                                                           t-as="values"
                                                           t-key="values_index">
                                                            <t t-foreach="values.expense_depreciation[0]"
                                                               t-as="income"
                                                               t-key="income_index">
                                                                <t t-if="income_name == income.name">
                                                                    <t t-if="income.amount != '0.00'">
                                                                        <t t-set="account_value"
                                                                           t-value="1"/>
                                                                    </t>
                                                                </t>
                                                            </t>
                                                        </t>
                                                        <t t-if="account_value == 1">
                                                            <tr class="border-bottom border-gainsboro collapse"
                                                                id="collapseDepreciation">
                                                                <th colspan="6">
                                                                    <span class="dropdown">
                                                                        <a class="dropdown-toggle"
                                                                           data-bs-toggle="dropdown">
                                                                            <span class="ms-5">
                                                                                <t t-esc="income.name"/>
                                                                            </span>
                                                                        </a>
                                                                        <span class="dropdown-menu">
                                                                            <a role="menuitem"
                                                                               t-on-click="show_gl"
                                                                               class="show_gl">
                                                                                General
                                                                                Ledger
                                                                            </a>
                                                                        </span>
                                                                    </span>
                                                                </th>
                                                                <t t-foreach="state.datas"
                                                                   t-as="values"
                                                                   t-key="values_index">
                                                                    <t t-foreach="values.expense_depreciation[0]"
                                                                       t-as="income"
                                                                       t-key="income_index">
                                                                        <t t-if="income_name == income.name">
                                                                            <th class="text-end">
                                                                                <span>
                                                                                    <t t-esc="income.amount"/>
                                                                                </span>
                                                                            </th>
                                                                        </t>
                                                                    </t>
                                                                </t>
                                                            </tr>
                                                        </t>
                                                    </t>
                                                </t>
                                            </t>
                                        </t>
                                        <t t-else="">
                                            <tr class="border-bottom border-gainsboro">
                                                <th colspan="6">
                                                    <span class="ms-2">
                                                        Depreciation
                                                    </span>
                                                </th>
                                            </tr>
                                        </t>
                                        <tr class="border-bottom border-gainsboro">
                                            <th colspan="6">
                                                <span class="fw-bolder ms-2">
                                                    Total
                                                    Expenses
                                                </span>
                                            </th>
                                            <t t-foreach="state.datas"
                                               t-as="total_expense"
                                               t-key="total_expense_index">
                                                <th class="text-end">
                                                    <span class="fw-bolder">
                                                        <t t-esc="total_expense.total_expense"/>
                                                    </span>
                                                </th>
                                            </t>
                                        </tr>
                                    </t>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </t>
</templates>
