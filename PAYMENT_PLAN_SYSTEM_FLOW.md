# Payment Plan System - Architecture & Flow Diagram

## 1. SYSTEM ARCHITECTURE OVERVIEW

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PAYMENT PLAN SYSTEM                          â”‚
â”‚                   (rental_management v3.4)                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DATA MODELS LAYER                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚  payment.schedule   â”‚â—„â”€â”€â”€â”€â”€â”¤payment.schedule.line â”‚          â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤          â”‚
â”‚  â”‚ name                â”‚ 1   *â”‚ percentage           â”‚          â”‚
â”‚  â”‚ schedule_type       â”‚      â”‚ days_after           â”‚          â”‚
â”‚  â”‚ total_percentage    â”‚      â”‚ installment_freq     â”‚          â”‚
â”‚  â”‚ schedule_line_idsâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”‚ number_of_installmts â”‚          â”‚
â”‚  â”‚ (computed: 100%)    â”‚      â”‚ name (description)   â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                 â”‚
â”‚           â–¼                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚      property.vendor (Sale Contract)         â”‚              â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤              â”‚
â”‚  â”‚ âœ… payment_schedule_id â”€â”€â”€â”€â”€â”€â”               â”‚              â”‚
â”‚  â”‚ âœ… use_schedule              â”‚ (CURRENTLY   â”‚              â”‚
â”‚  â”‚ âœ… sale_invoice_ids â—„â”€â”€â”€â”€â”€â”€â”€â”€â”¤  HIDDEN IN  â”‚              â”‚
â”‚  â”‚ âœ… dld_fee_type              â”‚  FORM VIEW) â”‚              â”‚
â”‚  â”‚ âœ… admin_fee_type            â”‚               â”‚              â”‚
â”‚  â”‚ âœ… include_dld_in_plan       â”‚               â”‚              â”‚
â”‚  â”‚ âœ… include_admin_in_plan     â”‚               â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                 â–¼                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                      â”‚
â”‚  â”‚  sale.invoice        â”‚  (Generated invoices)                â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                      â”‚
â”‚  â”‚ property_sold_id â”€â”€â”€â”€â”¼â”€â”€â–º property.vendor                   â”‚
â”‚  â”‚ name                 â”‚                                      â”‚
â”‚  â”‚ amount               â”‚                                      â”‚
â”‚  â”‚ invoice_date         â”‚                                      â”‚
â”‚  â”‚ invoice_type         â”‚  (booking, dld_fee, admin, etc.)     â”‚
â”‚  â”‚ invoice_id â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â–º account.move (actual invoice)     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                      â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. USER WORKFLOW - CURRENT STATE (Broken)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ USER OPENS PROPERTY VENDOR FORM (Stage: BOOKED)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILLS BASIC DETAILS                                          â”‚
â”‚ â”œâ”€ Customer                                                  â”‚
â”‚ â”œâ”€ Property                                                  â”‚
â”‚ â”œâ”€ Sale Price: AED 1,000,000                                â”‚
â”‚ â””â”€ Booking %: 30%                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ USER WANTS TO SELECT PAYMENT SCHEDULE                        â”‚
â”‚                                                              â”‚
â”‚ ğŸ” LOOKS FOR PAYMENT SCHEDULE FIELD...                       â”‚
â”‚                                                              â”‚
â”‚ âŒ FIELD NOT VISIBLE (Hidden in Python, not in XML form)    â”‚
â”‚                                                              â”‚
â”‚ â“ USER CONFUSED: "Where is payment schedule?"              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ USER CLICKS "CREATE INSTALLMENTS" BUTTON (only option)      â”‚
â”‚                                                              â”‚
â”‚ â–¶ Opens wizard                                              â”‚
â”‚ â–¶ Asks for "Payment Term" (dropdown: Monthly, Quarterly...)â”‚
â”‚ â–¶ Wizard calls property_vendor_wizard.py                    â”‚
â”‚ â–¶ Creates simple invoices (doesn't use payment_schedule!)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ RESULT: Simple Invoices Created                             â”‚
â”‚ â”œâ”€ No Booking amount                                        â”‚
â”‚ â”œâ”€ No DLD Fee                                               â”‚
â”‚ â”œâ”€ No Admin Fee                                             â”‚
â”‚ â””â”€ Just basic installments (limited options)                â”‚
â”‚                                                              â”‚
â”‚ âŒ Payment schedule system NEVER USED                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

REASON: â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ payment_schedule_id field exists in Python MODEL    â”‚
        â”‚ BUT NOT IN XML VIEW â†’ User can't see it             â”‚
        â”‚                                                     â”‚
        â”‚ action_generate_from_schedule() method exists       â”‚
        â”‚ BUT NO BUTTON TO CALL IT                            â”‚
        â”‚                                                     â”‚
        â”‚ Payment schedule system COMPLETE but INVISIBLE      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. USER WORKFLOW - AFTER IMPLEMENTATION (Fixed)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ USER OPENS PROPERTY VENDOR FORM (Stage: BOOKED)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILLS BASIC DETAILS                                            â”‚
â”‚ â”œâ”€ Customer                                                    â”‚
â”‚ â”œâ”€ Property                                                    â”‚
â”‚ â”œâ”€ Sale Price: AED 1,000,000                                  â”‚
â”‚ â”œâ”€ Booking %: 30%                                             â”‚
â”‚ â”œâ”€ DLD Fee %: 4%  âœ… NEW                                       â”‚
â”‚ â”œâ”€ Admin Fee: AED 5,000  âœ… NEW                                â”‚
â”‚ â””â”€ [Other fees...]                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ… NEW SECTION: "PAYMENT SCHEDULE CONFIGURATION"              â”‚
â”‚                                                                â”‚
â”‚ â”œâ”€ Payment Schedule [Dropdown] â—„â”€â”€â”€ NOW VISIBLE              â”‚
â”‚ â”‚  Shows: "30% Booking + 70% Quarterly"                      â”‚
â”‚ â”‚         "40% Booking + 60% Monthly"                        â”‚
â”‚ â”‚         "50% Booking + 50% Semi-Annual"                    â”‚
â”‚ â”‚         [Any template created by admin]                    â”‚
â”‚ â”‚                                                             â”‚
â”‚ â””â”€ âš¡ Generate from Schedule â—„â”€â”€â”€ NOW VISIBLE (on selection)  â”‚
â”‚                                                                â”‚
â”‚ USER SELECTS: "30% Booking + 70% Quarterly"                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ USER CLICKS "âš¡ Generate from Schedule" BUTTON                 â”‚
â”‚                                                                â”‚
â”‚ System Calculates:                                             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚ â”‚ 1. Booking: 30% of 1M = AED 300,000 @ Day 0  â”‚             â”‚
â”‚ â”‚ 2. DLD Fee: 4% of 1M = AED 40,000 @ Day 7    â”‚             â”‚
â”‚ â”‚ 3. Admin Fee: AED 5,000 @ Day 7              â”‚             â”‚
â”‚ â”‚ 4. Installment 1: 17.5% = AED 175,000 @ 30   â”‚             â”‚
â”‚ â”‚ 5. Installment 2: 17.5% = AED 175,000 @ 120  â”‚             â”‚
â”‚ â”‚ 6. Installment 3: 17.5% = AED 175,000 @ 210  â”‚             â”‚
â”‚ â”‚ 7. Installment 4: 17.5% = AED 175,000 @ 300  â”‚             â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                                â”‚
â”‚ âœ… Success: "Payment schedule generated with 7 invoices!"    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SCROLL TO "INVOICES" TAB                                       â”‚
â”‚                                                                â”‚
â”‚ See Payment Plan:                                              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ # â”‚ Type          â”‚ Description         â”‚ Amount â”‚ Date  â”‚ â”‚
â”‚ â”œâ”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚ â”‚1 â”‚ Booking       â”‚ Booking deposit     â”‚300,000 â”‚ Day 0 â”‚ â”‚
â”‚ â”‚2 â”‚ DLD Fee       â”‚ DLD registration    â”‚ 40,000 â”‚ Day 7 â”‚ â”‚
â”‚ â”‚3 â”‚ Admin Fee     â”‚ Administrative fee  â”‚  5,000 â”‚ Day 7 â”‚ â”‚
â”‚ â”‚4 â”‚ Installment   â”‚ Quarterly 1/4       â”‚175,000 â”‚Day 30 â”‚ â”‚
â”‚ â”‚5 â”‚ Installment   â”‚ Quarterly 2/4       â”‚175,000 â”‚Day 120â”‚ â”‚
â”‚ â”‚6 â”‚ Installment   â”‚ Quarterly 3/4       â”‚175,000 â”‚Day 210â”‚ â”‚
â”‚ â”‚7 â”‚ Installment   â”‚ Quarterly 4/4       â”‚175,000 â”‚Day 300â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                â”‚
â”‚ Total: AED 1,220,000 (includes all fees)                     â”‚
â”‚ âœ… Professional payment plan ready for customer               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ USER CAN NOW:                                                  â”‚
â”‚ â”œâ”€ âœ… Edit invoice dates if needed                            â”‚
â”‚ â”œâ”€ âœ… Modify descriptions                                     â”‚
â”‚ â”œâ”€ âœ… Click "Create Invoice" to generate account.move         â”‚
â”‚ â”œâ”€ âœ… Print SPA with payment schedule included                â”‚
â”‚ â”œâ”€ âœ… Send to customer for approval                           â”‚
â”‚ â””â”€ âœ… Track payments by type (booking, fees, installments)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. PAYMENT SCHEDULE TEMPLATE EXAMPLES

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TEMPLATE 1: "30% BOOKING + 70% QUARTERLY"                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Perfect for: Luxury properties with staggered payments         â”‚
â”‚                                                                  â”‚
â”‚ Schedule Lines:                                                 â”‚
â”‚ â”œâ”€ Line 1: "Booking Payment"                                   â”‚
â”‚ â”‚          30% | Day 0 | One Time | 1 installment             â”‚
â”‚ â”œâ”€ Line 2: "Quarterly 1"                                       â”‚
â”‚ â”‚          17.5% | Day 30 | One Time | 1 installment          â”‚
â”‚ â”œâ”€ Line 3: "Quarterly 2"                                       â”‚
â”‚ â”‚          17.5% | Day 120 | One Time | 1 installment         â”‚
â”‚ â”œâ”€ Line 4: "Quarterly 3"                                       â”‚
â”‚ â”‚          17.5% | Day 210 | One Time | 1 installment         â”‚
â”‚ â””â”€ Line 5: "Quarterly 4"                                       â”‚
â”‚            17.5% | Day 300 | One Time | 1 installment         â”‚
â”‚                                                                  â”‚
â”‚ Example Output (Sale Price: AED 1,000,000):                    â”‚
â”‚ Invoice 1: AED 300,000 @ Day 0 (Booking)                       â”‚
â”‚ Invoice 2: AED 175,000 @ Day 30                                â”‚
â”‚ Invoice 3: AED 175,000 @ Day 120                               â”‚
â”‚ Invoice 4: AED 175,000 @ Day 210                               â”‚
â”‚ Invoice 5: AED 175,000 @ Day 300                               â”‚
â”‚ Total Invoices: 5 (+ DLD fee, Admin fee if enabled = 7)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TEMPLATE 2: "50% BOOKING + 12 MONTHLY INSTALLMENTS"            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Perfect for: Residential units with monthly payment plans      â”‚
â”‚                                                                  â”‚
â”‚ Schedule Lines:                                                 â”‚
â”‚ â”œâ”€ Line 1: "Booking Payment"                                   â”‚
â”‚ â”‚          50% | Day 0 | One Time | 1 installment             â”‚
â”‚ â””â”€ Line 2: "Monthly Installments"                              â”‚
â”‚            50% | Day 0 | Monthly | 12 installments            â”‚
â”‚                                                                  â”‚
â”‚ Example Output (Sale Price: AED 600,000):                      â”‚
â”‚ Invoice 1: AED 300,000 @ Day 0 (Booking)                       â”‚
â”‚ Invoice 2: AED 25,000 @ Day 0 (Monthly 1/12)                   â”‚
â”‚ Invoice 3: AED 25,000 @ Day 30 (Monthly 2/12)                  â”‚
â”‚ Invoice 4: AED 25,000 @ Day 60 (Monthly 3/12)                  â”‚
â”‚ ... (8 more monthly invoices)                                   â”‚
â”‚ Invoice 13: AED 25,000 @ Day 330 (Monthly 12/12)               â”‚
â”‚ Total Invoices: 13 (+ fees if enabled = 15)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TEMPLATE 3: "COMMERCIAL - 40% BOOKING + 60% TWO PAYMENTS"     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Perfect for: Commercial properties with milestone payments     â”‚
â”‚                                                                  â”‚
â”‚ Schedule Lines:                                                 â”‚
â”‚ â”œâ”€ Line 1: "Initial Booking"                                   â”‚
â”‚ â”‚          40% | Day 0 | One Time | 1 installment             â”‚
â”‚ â”œâ”€ Line 2: "Construction Milestone"                            â”‚
â”‚ â”‚          30% | Day 180 | One Time | 1 installment           â”‚
â”‚ â””â”€ Line 3: "Final Settlement"                                  â”‚
â”‚            30% | Day 360 | One Time | 1 installment           â”‚
â”‚                                                                  â”‚
â”‚ Example Output (Sale Price: AED 5,000,000):                    â”‚
â”‚ Invoice 1: AED 2,000,000 @ Day 0 (Booking)                     â”‚
â”‚ Invoice 2: AED 1,500,000 @ Day 180 (Milestone)                 â”‚
â”‚ Invoice 3: AED 1,500,000 @ Day 360 (Final)                     â”‚
â”‚ Total Invoices: 3 (+ fees if enabled = 5)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. DATA GENERATION FLOW

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PAYMENT SCHEDULE (Template)                                    â”‚
â”‚ Name: "30% Booking + 70% Quarterly"                            â”‚
â”‚ Schedule Lines:                                                 â”‚
â”‚  - Line 1: 30%, Day 0, One Time, 1 invoice                    â”‚
â”‚  - Line 2: 17.5%, Day 30, One Time, 1 invoice                 â”‚
â”‚  - Line 3: 17.5%, Day 120, One Time, 1 invoice                â”‚
â”‚  - Line 4: 17.5%, Day 210, One Time, 1 invoice                â”‚
â”‚  - Line 5: 17.5%, Day 300, One Time, 1 invoice                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ User selects in property.vendor
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PROPERTY VENDOR (Sales Contract)                               â”‚
â”‚ â”œâ”€ payment_schedule_id = template above                        â”‚
â”‚ â”œâ”€ sale_price = 1,000,000 (100% amount)                        â”‚
â”‚ â”œâ”€ booking_percentage = 30%                                    â”‚
â”‚ â”œâ”€ dld_fee_percentage = 4%                                     â”‚
â”‚ â”œâ”€ admin_fee = 5,000                                           â”‚
â”‚ â”œâ”€ date (contract start) = 2025-01-01                          â”‚
â”‚ â”œâ”€ include_dld_in_plan = True                                  â”‚
â”‚ â””â”€ include_admin_in_plan = True                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ User clicks: Generate from Schedule
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CALCULATION ENGINE (action_generate_from_schedule)             â”‚
â”‚                                                                 â”‚
â”‚ Step 1: Extract amounts                                        â”‚
â”‚ â”œâ”€ base_amount = 1,000,000                                     â”‚
â”‚ â”œâ”€ booking_amt = 30% Ã— 1M = 300,000                            â”‚
â”‚ â”œâ”€ dld_amt = 4% Ã— 1M = 40,000                                  â”‚
â”‚ â”œâ”€ admin_amt = 5,000                                           â”‚
â”‚ â””â”€ remaining = 1M - 300k = 700,000                             â”‚
â”‚                                                                 â”‚
â”‚ Step 2: Generate booking invoice                               â”‚
â”‚ â”œâ”€ Create sale.invoice                                         â”‚
â”‚ â”œâ”€ amount = 300,000                                            â”‚
â”‚ â”œâ”€ invoice_date = 2025-01-01 + 0 days = 2025-01-01            â”‚
â”‚ â”œâ”€ invoice_type = 'booking'                                    â”‚
â”‚ â”œâ”€ sequence = 1                                                â”‚
â”‚ â””â”€ property_sold_id = current contract                         â”‚
â”‚                                                                 â”‚
â”‚ Step 3: Generate DLD fee invoice                               â”‚
â”‚ â”œâ”€ Create sale.invoice                                         â”‚
â”‚ â”œâ”€ amount = 40,000                                             â”‚
â”‚ â”œâ”€ invoice_date = 2025-01-01 + 7 days = 2025-01-08            â”‚
â”‚ â”œâ”€ invoice_type = 'dld_fee'                                    â”‚
â”‚ â”œâ”€ sequence = 2                                                â”‚
â”‚ â””â”€ property_sold_id = current contract                         â”‚
â”‚                                                                 â”‚
â”‚ Step 4: Generate admin fee invoice                             â”‚
â”‚ â”œâ”€ Create sale.invoice                                         â”‚
â”‚ â”œâ”€ amount = 5,000                                              â”‚
â”‚ â”œâ”€ invoice_date = 2025-01-01 + 7 days = 2025-01-08            â”‚
â”‚ â”œâ”€ invoice_type = 'admin_fee'                                  â”‚
â”‚ â”œâ”€ sequence = 3                                                â”‚
â”‚ â””â”€ property_sold_id = current contract                         â”‚
â”‚                                                                 â”‚
â”‚ Step 5: Generate schedule invoices for each line               â”‚
â”‚ â”œâ”€ For each schedule_line in payment_schedule.schedule_line_ids:
â”‚ â”‚  â”œâ”€ line_amount = (remaining Ã— percentage) / 100             â”‚
â”‚ â”‚  â”œâ”€ For installment_num in range(number_of_installments):   â”‚
â”‚ â”‚  â”‚  â”œâ”€ Create sale.invoice                                  â”‚
â”‚ â”‚  â”‚  â”œâ”€ amount = line_amount / num_installments              â”‚
â”‚ â”‚  â”‚  â”œâ”€ invoice_date = contract_date + days_after            â”‚
â”‚ â”‚  â”‚  â”‚              + (installment_num Ã— frequency_days)     â”‚
â”‚ â”‚  â”‚  â”œâ”€ invoice_type = 'installment'                         â”‚
â”‚ â”‚  â”‚  â””â”€ sequence += 1                                        â”‚
â”‚ â”‚  â””â”€ end loop                                                 â”‚
â”‚ â””â”€ end loop                                                     â”‚
â”‚                                                                 â”‚
â”‚ Result: 7 sale.invoice records created                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SALE INVOICES (Temporary Schedules)                            â”‚
â”‚ 1. Booking Payment | 300,000 | 2025-01-01                      â”‚
â”‚ 2. DLD Fee | 40,000 | 2025-01-08                               â”‚
â”‚ 3. Admin Fee | 5,000 | 2025-01-08                              â”‚
â”‚ 4. Installment 1 | 175,000 | 2025-01-31                        â”‚
â”‚ 5. Installment 2 | 175,000 | 2025-04-30                        â”‚
â”‚ 6. Installment 3 | 175,000 | 2025-07-29                        â”‚
â”‚ 7. Installment 4 | 175,000 | 2025-10-27                        â”‚
â”‚                                                                 â”‚
â”‚ Each can be converted to account.move when ready:              â”‚
â”‚ User clicks "Create Invoice" button                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ Each invoice can be converted
                             â”‚ (when customer ready to pay)
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ACCOUNT.MOVE (Actual Odoo Invoices)                            â”‚
â”‚ 1. Invoice AED/2025/001: Booking | 300,000 | 2025-01-01       â”‚
â”‚    - Posted and sent to customer                              â”‚
â”‚    - Payment can be tracked in Odoo                            â”‚
â”‚ 2. Invoice AED/2025/002: DLD Fee | 40,000 | 2025-01-08        â”‚
â”‚ ... (etc for all invoices)                                    â”‚
â”‚                                                                 â”‚
â”‚ Can create all 7 at once or gradually as customer pays        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 6. COMPARISON: OLD vs NEW

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    OLD WORKFLOW                              â”‚
â”‚                   (Still Active)                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

User Flow:
â”œâ”€ Click "Create Installments" â†’ Opens wizard
â”œâ”€ Select "Payment Term" dropdown (Monthly, Quarterly, etc.)
â”œâ”€ Wizard calculates: sale_price / num_months
â””â”€ Creates simple equal-amount invoices

Example (Sale: 600K, Monthly):
â”œâ”€ Invoice 1: 50K @ Month 1
â”œâ”€ Invoice 2: 50K @ Month 2
â”œâ”€ Invoice 3: 50K @ Month 3
â””â”€ ... (12 total)

Limitations:
âŒ No Booking amount
âŒ No DLD Fee
âŒ No Admin Fee
âŒ Fixed to dropdown options
âŒ Always equal amounts
âŒ No recurring pattern support

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    NEW WORKFLOW                              â”‚
â”‚                   (After Implementation)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

User Flow:
â”œâ”€ Select "Payment Schedule" dropdown (admin-created templates)
â”œâ”€ Click "Generate from Schedule"
â”œâ”€ System generates complete payment plan
â””â”€ Invoices include booking + fees + installments

Example (Sale: 600K, "50% Booking + 12 Monthly"):
â”œâ”€ Invoice 1: 300K @ Day 0 (Booking)
â”œâ”€ Invoice 2: 24K @ Month 1 (Monthly)
â”œâ”€ Invoice 3: 24K @ Month 2 (Monthly)
â”œâ”€ ... (12 monthly)
â”œâ”€ Plus: DLD Fee if enabled
â”œâ”€ Plus: Admin Fee if enabled

Advantages:
âœ… Includes Booking amount
âœ… Includes DLD Fee (4% standard)
âœ… Includes Admin Fee (fixed or %)
âœ… Unlimited template options
âœ… Flexible payment patterns
âœ… Professional payment plans
âœ… Recurring support (Monthly, Quarterly, Annual)
âœ… Auditable invoice breakdown

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ BOTH SYSTEMS COEXIST:                                        â”‚
â”‚ - Wizard still available (for simple cases)                  â”‚
â”‚ - Payment Schedule system NEW (for complex cases)            â”‚
â”‚ - Admin chooses which template to support                    â”‚
â”‚ - User can use either method                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 7. SYSTEM STATE DIAGRAM

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PROPERTY VENDOR RECORD LIFECYCLE       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Stage: BOOKED
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ… Fields Editable:                     â”‚
â”‚ â”œâ”€ Customer                             â”‚
â”‚ â”œâ”€ Property                             â”‚
â”‚ â”œâ”€ Sale Price                           â”‚
â”‚ â”œâ”€ Payment Schedule â—„â”€â”€â”€ NOW VISIBLE   â”‚
â”‚ â”œâ”€ DLD/Admin Fee Settings               â”‚
â”‚ â””â”€ Booking Settings                     â”‚
â”‚                                        â”‚
â”‚ âœ… Actions Available:                   â”‚
â”‚ â”œâ”€ Create Installments (Old wizard)     â”‚
â”‚ â”œâ”€ âš¡ Generate from Schedule â—„â”€â”€â”€ NEW  â”‚
â”‚ â””â”€ Reset Installments                   â”‚
â”‚                                        â”‚
â”‚ âœ… Results in:                          â”‚
â”‚ â””â”€ sale.invoice records (in memory)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ User clicks "Confirm Sale"
         â”‚
         â–¼
Stage: SOLD
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âŒ Fields Read-only:                    â”‚
â”‚ â”œâ”€ Customer (locked)                    â”‚
â”‚ â”œâ”€ Property (locked)                    â”‚
â”‚ â”œâ”€ Sale Price (locked)                  â”‚
â”‚ â”œâ”€ Payment Schedule (locked)             â”‚
â”‚ â””â”€ All other details (locked)           â”‚
â”‚                                        â”‚
â”‚ âœ… Actions Available:                   â”‚
â”‚ â”œâ”€ Create Invoice (from sale.invoices)  â”‚
â”‚ â”œâ”€ Receive Remaining Payment            â”‚
â”‚ â”œâ”€ Print SPA                            â”‚
â”‚ â””â”€ Maintenance Request                  â”‚
â”‚                                        â”‚
â”‚ âœ… Can Perform:                         â”‚
â”‚ â”œâ”€ Generate individual account.move     â”‚
â”‚ â”œâ”€ Track payment status                 â”‚
â”‚ â”œâ”€ Print reports with schedule          â”‚
â”‚ â””â”€ Send payment reminders               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ (Optional) User clicks "Locked"
         â”‚
         â–¼
Stage: LOCKED (Final)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âŒ All fields read-only                 â”‚
â”‚ âŒ All actions disabled                 â”‚
â”‚ âœ… Archive/Reporting only               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 8. KEY FORMULA & CALCULATIONS

```
BOOKING INVOICE AMOUNT:
  booking_amt = sale_price Ã— (booking_percentage / 100)
  Example: 1,000,000 Ã— (30 / 100) = 300,000

DLD FEE AMOUNT:
  IF dld_fee_type == 'percentage':
    dld_amt = sale_price Ã— (dld_fee_percentage / 100)
    Example: 1,000,000 Ã— (4 / 100) = 40,000
  ELSE IF dld_fee_type == 'fixed':
    dld_amt = dld_fee (manual entry)
    Example: 50,000

ADMIN FEE AMOUNT:
  IF admin_fee_type == 'percentage':
    admin_amt = sale_price Ã— (admin_fee_percentage / 100)
    Example: 1,000,000 Ã— (0.5 / 100) = 5,000
  ELSE IF admin_fee_type == 'fixed':
    admin_amt = admin_fee (manual entry)
    Example: 5,000

REMAINING AMOUNT (for schedule lines):
  remaining = sale_price - booking_amt
  Example: 1,000,000 - 300,000 = 700,000

SCHEDULE LINE AMOUNT:
  FOR each schedule_line:
    line_amt = (remaining Ã— schedule_line.percentage) / 100
    Example (Line 1: 25%): 700,000 Ã— (25 / 100) = 175,000

SPLIT INTO INSTALLMENTS:
  per_invoice = line_amt / number_of_installments
  Example (4 installments): 175,000 / 4 = 43,750 each

INVOICE DUE DATE:
  due_date = contract_start_date + days_after + (installment_num Ã— frequency_days)
  Example (Day 30, Monthly, Installment 2):
    2025-01-01 + 30 + (1 Ã— 30) = 2025-02-28

TOTAL PAYABLE:
  total = booking_amt + dld_amt + admin_amt + sum(schedule amounts)
  Example: 300K + 40K + 5K + 175K + 175K + 175K + 175K = 1,220,000
```

---

**System Architecture Complete** âœ…  
**Ready for Implementation** âœ…
