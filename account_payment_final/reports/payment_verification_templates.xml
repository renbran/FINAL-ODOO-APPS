<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <!-- Enhanced OSUS Payment Voucher Template -->
        <template id="report_payment_voucher_osus" name="OSUS Payment Voucher">
            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="o">
                    <t t-call="web.external_layout">
                        <div class="page">
                            <!-- Custom CSS for OSUS Styling -->
                            <style>
                                .voucher-header {
                                    background: linear-gradient(135deg, #6B2B47, #8B1538);
                                    color: white;
                                    padding: 15px;
                                    margin: -15px -15px 20px -15px;
                                    box-shadow: 0 2px 4px rgba(0,0,0,0.3);
                                }
                                .voucher-title {
                                    text-align: center;
                                    font-size: 28px;
                                    font-weight: bold;
                                    letter-spacing: 2px;
                                    margin-bottom: 0;
                                    text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
                                }
                                .voucher-subtitle {
                                    text-align: center;
                                    font-size: 16px;
                                    margin: 5px 0 0 0;
                                }
                                .company-info {
                                    font-size: 13px;
                                    line-height: 1.3;
                                    font-weight: 500;
                                    text-shadow: 1px 1px 1px rgba(0,0,0,0.2);
                                }
                                .field-label {
                                    color: #6b0632ff;
                                    font-weight: bold;
                                    font-size: 14px;
                                    margin-bottom: 5px;
                                }
                                .field-value {
                                    border-bottom: 2px solid #333;
                                    padding-bottom: 3px;
                                    margin-bottom: 15px;
                                    min-height: 20px;
                                    color: #000;
                                    font-weight: 500;
                                    font-size: 13px;
                                }
                                .amount-section {
                                    background: linear-gradient(135deg, #b19024ff, #8B6F00);
                                    color: white;
                                    padding: 15px;
                                    text-align: center;
                                    margin: 20px 0;
                                    font-size: 18px;
                                    font-weight: bold;
                                    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
                                    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
                                }
                                .signature-section {
                                    margin-top: 40px;
                                }
                                .signature-box {
                                    text-align: center;
                                    padding: 10px;
                                    margin-bottom: 10px;
                                }
                                .signature-line {
                                    border-bottom: 2px solid #000;
                                    margin-bottom: 5px;
                                    height: 30px;
                                }
                                .footer-note {
                                    background: linear-gradient(135deg, #6B2B47, #8B1538);
                                    color: white;
                                    text-align: center;
                                    padding: 12px;
                                    font-size: 13px;
                                    font-weight: 500;
                                    margin: 20px -15px -15px -15px;
                                    box-shadow: 0 -2px 4px rgba(0,0,0,0.3);
                                    text-shadow: 1px 1px 1px rgba(0,0,0,0.2);
                                }
                                .creator-info {
                                    font-size: 12px;
                                    color: #333;
                                    margin-top: 5px;
                                    font-style: italic;
                                    font-weight: 500;
                                }
                                .authorized-name {
                                    font-size: 14px;
                                    font-weight: bold;
                                    color: #000;
                                }
                                .signature-initials {
                                    font-size: 14px;
                                    font-weight: bold;
                                    color: #6B2B47;
                                    font-style: italic;
                                    margin-top: 10px;
                                    margin-bottom: 5px;
                                    letter-spacing: 1px;
                                    max-height: 60px;
                                    overflow: hidden;
                                }
                                .user-signature {
                                    font-family: cursive, 'Brush Script MT', fantasy;
                                    font-size: 16px;
                                    color: #6B2B47;
                                    margin-top: 5px;
                                    margin-bottom: 5px;
                                    max-height: 50px;
                                    overflow: hidden;
                                }
                                .qr-section {
                                    text-align: center;
                                    margin: 20px 0;
                                    padding: 15px;
                                    background: #f8f9fa;
                                    border-radius: 8px;
                                }
                                .document-details-table {
                                    width: 100%;
                                    font-size: 12px;
                                    border-collapse: collapse;
                                    margin-top: 10px;
                                }
                                .document-details-table th,
                                .document-details-table td {
                                    padding: 8px;
                                    border: 1px solid #ccc;
                                    text-align: left;
                                }
                                .document-details-table th {
                                    background-color: #6b0632ff;
                                    color: white;
                                    font-weight: bold;
                                }
                                .workflow-status {
                                    margin: 20px 0;
                                    padding: 15px;
                                    background-color: #f8f9fa;
                                    border-left: 4px solid #6b0632ff;
                                    border-radius: 4px;
                                }
                            </style>

                            <!-- Header Section -->
                            <div class="voucher-header">
                                <div class="row">
                                    <div class="col-6">
                                        <div class="company-info">
                                            <strong>OSUS REAL ESTATE BROKERAGE LLC</strong><br/>
                                            Single Tower<br/>
                                            Business Bay<br/>
                                            29th Floor<br/>
                                            Dubai<br/>
                                            United Arab Emirates
                                        </div>
                                    </div>
                                    <div class="col-6">
                                        <h2 class="voucher-title">
                                            <t t-if="o.payment_type == 'inbound'">RECEIPT VOUCHER</t>
                                            <t t-else="">PAYMENT VOUCHER</t>
                                        </h2>
                                        <div class="voucher-subtitle">
                                            <strong>Reference: <span t-field="o.voucher_number"/></strong>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Workflow Status -->
                            <div class="workflow-status">
                                <strong>Status: </strong>
                                <span t-field="o.approval_state" class="badge badge-info"/>
                                <t t-if="o.workflow_step > 0">
                                    - Step <span t-esc="o.workflow_step"/> of <span t-esc="o.total_steps"/>
                                </t>
                            </div>

                            <!-- Main Content -->
                            <div class="row">
                                <!-- Left Column -->
                                <div class="col-6">
                                    <!-- Issue To Section -->
                                    <div class="field-label">
                                        <t t-if="o.payment_type == 'inbound'">Received from:</t>
                                        <t t-else="">Pay to:</t>
                                    </div>
                                    <div class="field-value">
                                        <span t-field="o.partner_id.name"/>
                                    </div>

                                    <!-- Phone Section -->
                                    <div class="field-label">Phone</div>
                                    <div class="field-value">
                                        <span t-field="o.partner_id.mobile"/>
                                        <t t-if="not o.partner_id.mobile">-</t>
                                    </div>

                                    <!-- Payment Method Section -->
                                    <div class="field-label">Payment Method</div>
                                    <div class="field-value">
                                        <span t-field="o.journal_id.name"/>
                                    </div>

                                    <!-- Related Document Section -->
                                    <t t-set="doc_info" t-value="o.get_related_document_info()"/>
                                    <div class="field-label">
                                        <span t-esc="doc_info['label']"/>
                                    </div>
                                    <div class="field-value">
                                        <span t-esc="doc_info['references']"/>
                                    </div>
                                </div>

                                <!-- Right Column -->
                                <div class="col-6">
                                    <!-- Date Section -->
                                    <div class="field-label">Date:</div>
                                    <div class="field-value">
                                        <span t-field="o.date" t-options='{"widget": "date"}'/>
                                    </div>

                                    <!-- Remarks Section -->
                                    <div class="field-label">Remarks</div>
                                    <div class="field-value" style="min-height: 60px;">
                                        <span t-field="o.remarks"/>
                                        <t t-if="not o.remarks">-</t>
                                    </div>

                                    <!-- QR Code Section -->
                                    <t t-if="o.qr_code and o.qr_in_report">
                                        <div class="qr-section">
                                            <div class="field-label">Verification QR Code</div>
                                            <img t-att-src="'data:image/png;base64,%s' % o.qr_code.decode('utf-8')" 
                                                 alt="Payment Verification QR Code"
                                                 style="width: 120px; height: 120px;"/>
                                            <br/>
                                            <small>Scan to verify payment</small>
                                        </div>
                                    </t>
                                </div>
                            </div>

                            <!-- Amount in Words Section -->
                            <div class="field-label">Amount in words</div>
                            <div class="field-value" style="min-height: 30px;">
                                <span t-esc="o.amount_in_words"/>
                            </div>

                            <!-- Amount Section -->
                            <div class="amount-section">
                                <strong>
                                    <t t-if="o.payment_type == 'inbound'">AMOUNT RECEIVED: </t>
                                    <t t-else="">AMOUNT PAID: </t>
                                    <span t-field="o.currency_id.symbol"/><span t-field="o.amount" t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
                                </strong>
                            </div>

                            <!-- Detailed Document Information -->
                            <t t-set="doc_info" t-value="o.get_related_document_info()"/>
                            <t t-if="doc_info['count'] &gt; 1">
                                <div style="margin: 20px 0; padding: 15px; background-color: #f8f9fa; border-left: 4px solid #6b0632ff;">
                                    <div class="field-label" style="margin-bottom: 10px;">
                                        Document Details (<t t-esc="doc_info['count']"/> documents)
                                    </div>
                                    <table class="document-details-table">
                                        <thead>
                                            <tr>
                                                <th>Document #</th>
                                                <th>Type</th>
                                                <th>Date</th>
                                                <th>Amount</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <t t-foreach="doc_info['documents']" t-as="doc">
                                                <tr>
                                                    <td><span t-esc="doc.name"/></td>
                                                    <td>
                                                        <t t-if="doc.move_type == 'out_invoice'">Customer Invoice</t>
                                                        <t t-elif="doc.move_type == 'in_invoice'">Vendor Bill</t>
                                                        <t t-elif="doc.move_type == 'out_refund'">Customer Credit Note</t>
                                                        <t t-elif="doc.move_type == 'in_refund'">Vendor Credit Note</t>
                                                        <t t-else=""><t t-esc="doc.move_type"/></t>
                                                    </td>
                                                    <td><span t-field="doc.invoice_date" t-options='{"widget": "date"}'/></td>
                                                    <td><span t-field="doc.amount_total" t-options='{"widget": "monetary", "display_currency": doc.currency_id}'/></td>
                                                </tr>
                                            </t>
                                        </tbody>
                                    </table>
                                </div>
                            </t>

                            <!-- Signature Section -->
                            <div class="signature-section">
                                <t t-set="signatories" t-value="o.get_signatory_info()"/>
                                
                                <!-- Payment Voucher Signatures (4 required + receiver) -->
                                <t t-if="o.payment_type == 'outbound'">
                                    <div class="row">
                                        <!-- Creator Signature -->
                                        <div class="col-3">
                                            <div class="signature-box">
                                                <div class="signature-line">
                                                    <t t-if="o.creator_signature">
                                                        <img t-att-src="'data:image/png;base64,%s' % o.creator_signature.decode('utf-8')" 
                                                             style="max-height: 25px; max-width: 100%;"/>
                                                    </t>
                                                </div>
                                                <div class="signature-initials">
                                                    <t t-if="o.create_uid">
                                                        <span t-esc="''.join([n[0].upper() for n in o.create_uid.name.split()[:2]])"/>
                                                    </t>
                                                </div>
                                                <div class="authorized-name">Created By</div>
                                                <div class="creator-info">
                                                    <t t-if="o.create_uid">
                                                        <span t-field="o.create_uid.name"/><br/>
                                                        <span t-field="o.create_date" t-options='{"widget": "datetime"}'/>
                                                    </t>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Reviewer Signature -->
                                        <div class="col-3">
                                            <div class="signature-box">
                                                <div class="signature-line">
                                                    <t t-if="o.reviewer_signature">
                                                        <img t-att-src="'data:image/png;base64,%s' % o.reviewer_signature.decode('utf-8')" 
                                                             style="max-height: 25px; max-width: 100%;"/>
                                                    </t>
                                                </div>
                                                <div class="signature-initials">
                                                    <t t-if="o.reviewed_by">
                                                        <span t-esc="''.join([n[0].upper() for n in o.reviewed_by.name.split()[:2]])"/>
                                                    </t>
                                                </div>
                                                <div class="authorized-name">Reviewed By</div>
                                                <div class="creator-info">
                                                    <t t-if="o.reviewed_by">
                                                        <span t-field="o.reviewed_by.name"/><br/>
                                                        <span t-field="o.reviewed_date" t-options='{"widget": "datetime"}'/>
                                                    </t>
                                                    <t t-else="">
                                                        <span style="color: #dc3545;">Pending Review</span>
                                                    </t>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Approver Signature -->
                                        <div class="col-3">
                                            <div class="signature-box">
                                                <div class="signature-line">
                                                    <t t-if="o.approver_signature">
                                                        <img t-att-src="'data:image/png;base64,%s' % o.approver_signature.decode('utf-8')" 
                                                             style="max-height: 25px; max-width: 100%;"/>
                                                    </t>
                                                </div>
                                                <div class="signature-initials">
                                                    <t t-if="o.approved_by">
                                                        <span t-esc="''.join([n[0].upper() for n in o.approved_by.name.split()[:2]])"/>
                                                    </t>
                                                </div>
                                                <div class="authorized-name">Approved By</div>
                                                <div class="creator-info">
                                                    <t t-if="o.approved_by">
                                                        <span t-field="o.approved_by.name"/><br/>
                                                        <span t-field="o.approved_date" t-options='{"widget": "datetime"}'/>
                                                    </t>
                                                    <t t-else="">
                                                        <span style="color: #dc3545;">Pending Approval</span>
                                                    </t>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Authorizer Signature -->
                                        <div class="col-3">
                                            <div class="signature-box">
                                                <div class="signature-line">
                                                    <t t-if="o.authorizer_signature">
                                                        <img t-att-src="'data:image/png;base64,%s' % o.authorizer_signature.decode('utf-8')" 
                                                             style="max-height: 25px; max-width: 100%;"/>
                                                    </t>
                                                </div>
                                                <div class="signature-initials">
                                                    <t t-if="o.authorized_by">
                                                        <span t-esc="''.join([n[0].upper() for n in o.authorized_by.name.split()[:2]])"/>
                                                    </t>
                                                </div>
                                                <div class="authorized-name">Authorized By</div>
                                                <div class="creator-info">
                                                    <t t-if="o.authorized_by">
                                                        <span t-field="o.authorized_by.name"/><br/>
                                                        <span t-field="o.authorized_date" t-options='{"widget": "datetime"}'/>
                                                    </t>
                                                    <t t-else="">
                                                        <span style="color: #dc3545;">Pending Authorization</span>
                                                    </t>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Receiver Signature (Second Row) -->
                                    <div class="row" style="margin-top: 20px;">
                                        <div class="col-6">
                                            <div class="signature-box">
                                                <div class="signature-line">
                                                    <t t-if="o.receiver_signature">
                                                        <img t-att-src="'data:image/png;base64,%s' % o.receiver_signature.decode('utf-8')" 
                                                             style="max-height: 25px; max-width: 100%;"/>
                                                    </t>
                                                </div>
                                                <div class="authorized-name">Receiver Signature</div>
                                                <div class="creator-info">
                                                    Signature of the person receiving payment
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-6">
                                            <div class="signature-box">
                                                <div class="signature-line"></div>
                                                <div class="authorized-name">Posted By</div>
                                                <div class="creator-info">
                                                    <t t-if="o.posted_by">
                                                        <span t-field="o.posted_by.name"/><br/>
                                                        <span t-field="o.posted_date" t-options='{"widget": "datetime"}'/>
                                                    </t>
                                                    <t t-else="">
                                                        <span style="color: #dc3545;">Pending Posting</span>
                                                    </t>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </t>

                                <!-- Receipt Voucher Signatures (3 required: creator, reviewer, poster) -->
                                <t t-if="o.payment_type == 'inbound'">
                                    <div class="row">
                                        <!-- Creator Signature -->
                                        <div class="col-4">
                                            <div class="signature-box">
                                                <div class="signature-line">
                                                    <t t-if="o.creator_signature">
                                                        <img t-att-src="'data:image/png;base64,%s' % o.creator_signature.decode('utf-8')" 
                                                             style="max-height: 25px; max-width: 100%;"/>
                                                    </t>
                                                </div>
                                                <div class="signature-initials">
                                                    <t t-if="o.create_uid">
                                                        <span t-esc="''.join([n[0].upper() for n in o.create_uid.name.split()[:2]])"/>
                                                    </t>
                                                </div>
                                                <div class="authorized-name">Created By</div>
                                                <div class="creator-info">
                                                    <t t-if="o.create_uid">
                                                        <span t-field="o.create_uid.name"/><br/>
                                                        <span t-field="o.create_date" t-options='{"widget": "datetime"}'/>
                                                    </t>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Reviewer Signature -->
                                        <div class="col-4">
                                            <div class="signature-box">
                                                <div class="signature-line">
                                                    <t t-if="o.reviewer_signature">
                                                        <img t-att-src="'data:image/png;base64,%s' % o.reviewer_signature.decode('utf-8')" 
                                                             style="max-height: 25px; max-width: 100%;"/>
                                                    </t>
                                                </div>
                                                <div class="signature-initials">
                                                    <t t-if="o.reviewed_by">
                                                        <span t-esc="''.join([n[0].upper() for n in o.reviewed_by.name.split()[:2]])"/>
                                                    </t>
                                                </div>
                                                <div class="authorized-name">Reviewed By</div>
                                                <div class="creator-info">
                                                    <t t-if="o.reviewed_by">
                                                        <span t-field="o.reviewed_by.name"/><br/>
                                                        <span t-field="o.reviewed_date" t-options='{"widget": "datetime"}'/>
                                                    </t>
                                                    <t t-else="">
                                                        <span style="color: #dc3545;">Pending Review</span>
                                                    </t>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Posted By -->
                                        <div class="col-4">
                                            <div class="signature-box">
                                                <div class="signature-line"></div>
                                                <div class="authorized-name">Posted By</div>
                                                <div class="creator-info">
                                                    <t t-if="o.posted_by">
                                                        <span t-field="o.posted_by.name"/><br/>
                                                        <span t-field="o.posted_date" t-options='{"widget": "datetime"}'/>
                                                    </t>
                                                    <t t-else="">
                                                        <span style="color: #dc3545;">Pending Posting</span>
                                                    </t>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </t>
                            </div>

                            <!-- Footer -->
                            <div class="footer-note">
                                <p style="margin: 0;">
                                    <t t-if="o.company_id.voucher_footer_message">
                                        <span t-field="o.company_id.voucher_footer_message"/>
                                    </t>
                                    <t t-else="">
                                        Thank you for your business with OSUS Real Estate
                                    </t>
                                </p>
                                <p style="margin: 5px 0 0 0; font-size: 11px;">
                                    This is a computer-generated document. For verification, scan the QR code or visit our website.
                                </p>
                            </div>

                            <div class="oe_structure"/>
                        </div>
                    </t>
                </t>
            </t>
        </template>

        <!-- QR Verification Templates -->
        <template id="payment_verification_success" name="Payment Verification Success">
            <t t-call="website.layout">
                <div class="container py-5">
                    <div class="row justify-content-center">
                        <div class="col-md-8">
                            <div class="card shadow-lg border-0">
                                <div class="card-header bg-success text-white text-center py-4">
                                    <i class="fa fa-check-circle fa-3x mb-3"></i>
                                    <h2 class="mb-0">Payment Verified Successfully</h2>
                                    <p class="mb-0 opacity-75">Voucher #<span t-esc="voucher_number"/></p>
                                </div>
                                
                                <div class="card-body p-5">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <h5 class="text-success mb-3">
                                                <i class="fa fa-info-circle me-2"></i>Payment Details
                                            </h5>
                                            <table class="table table-borderless">
                                                <tr>
                                                    <td class="text-muted">Voucher Number:</td>
                                                    <td class="fw-bold" t-esc="voucher_number"/>
                                                </tr>
                                                <tr>
                                                    <td class="text-muted">Partner:</td>
                                                    <td class="fw-bold" t-esc="partner_name"/>
                                                </tr>
                                                <tr>
                                                    <td class="text-muted">Amount:</td>
                                                    <td class="fw-bold text-success">
                                                        <span t-esc="amount"/> <span t-esc="currency"/>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td class="text-muted">Date:</td>
                                                    <td class="fw-bold" t-esc="date"/>
                                                </tr>
                                                <tr>
                                                    <td class="text-muted">Status:</td>
                                                    <td>
                                                        <span class="badge bg-success">
                                                            <t t-if="is_posted">Posted</t>
                                                            <t t-else=""><span t-esc="status.title()"/></t>
                                                        </span>
                                                    </td>
                                                </tr>
                                            </table>
                                        </div>
                                        
                                        <div class="col-md-6">
                                            <h5 class="text-primary mb-3">
                                                <i class="fa fa-building me-2"></i>Company Information
                                            </h5>
                                            <div class="bg-light p-3 rounded">
                                                <strong t-esc="company_name"/><br/>
                                                <small class="text-muted">
                                                    OSUS Real Estate Brokerage LLC<br/>
                                                    Single Tower, Business Bay<br/>
                                                    29th Floor, Dubai, UAE
                                                </small>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="text-center mt-4">
                                        <div class="alert alert-success" role="alert">
                                            <i class="fa fa-shield-alt me-2"></i>
                                            <strong>Verification Complete:</strong> 
                                            This payment voucher is authentic and has been verified against our records.
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="card-footer text-center text-muted py-3">
                                    <small>
                                        Verified on <span t-esc="verification_date"/> | 
                                        Powered by OSUS Payment Verification System
                                    </small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </t>
        </template>

        <template id="payment_verification_error" name="Payment Verification Error">
            <t t-call="website.layout">
                <div class="container py-5">
                    <div class="row justify-content-center">
                        <div class="col-md-6">
                            <div class="card shadow border-0">
                                <div class="card-header bg-danger text-white text-center py-4">
                                    <i class="fa fa-times-circle fa-3x mb-3"></i>
                                    <h2 class="mb-0" t-esc="error_message"/>
                                </div>
                                <div class="card-body text-center p-5">
                                    <p class="text-muted mb-4" t-esc="error_details"/>
                                    <a href="/" class="btn btn-primary">
                                        <i class="fa fa-home me-2"></i>Return to Home
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </t>
        </template>

        <template id="qr_verification_guide" name="QR Verification Guide">
            <t t-call="website.layout">
                <div class="container py-5">
                    <div class="row justify-content-center">
                        <div class="col-md-8">
                            <div class="card shadow">
                                <div class="card-header bg-primary text-white">
                                    <h3 class="mb-0">
                                        <i class="fa fa-qrcode me-2"></i>
                                        Payment QR Code Verification Guide
                                    </h3>
                                </div>
                                <div class="card-body p-4">
                                    <h5>How to verify payment vouchers:</h5>
                                    <ol class="list-group list-group-numbered">
                                        <li class="list-group-item">Scan the QR code on the payment voucher using your phone camera or QR scanner app</li>
                                        <li class="list-group-item">You will be directed to a verification page showing payment details</li>
                                        <li class="list-group-item">Check that the amount, recipient, and date match the voucher</li>
                                        <li class="list-group-item">Look for the green "VERIFIED" status to confirm authenticity</li>
                                    </ol>
                                    
                                    <div class="alert alert-info mt-4">
                                        <strong>Note:</strong> All payment vouchers from <span t-esc="company_name"/> include QR codes for security verification.
                                        If you cannot scan the QR code, please contact our support team for manual verification.
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </t>
        </template>
    </data>
</odoo>