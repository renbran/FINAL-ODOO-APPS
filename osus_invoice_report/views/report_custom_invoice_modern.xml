<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="report_custom_invoice_modern">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="doc">
                <t t-set="o" t-value="doc.with_context(lang=lang)"/>
                <t t-set="format_uk_date" t-value="lambda d: d.strftime('%d/%m/%Y') if d else ''"/>
                <div class="page" style="padding: 15px; font-family: Arial, sans-serif; font-size: 12px;">
                    <!-- Custom Header with Company Info -->
                    <div style="background-color: #800020; color: white; padding: 15px; margin-bottom: 20px;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div style="display: flex; align-items: center;">
                                <!-- Company Logo -->
                                <div style="width: 60px; height: 60px; background: rgba(255,255,255,0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 15px;">
                                    <span style="font-size: 20px; font-weight: bold;">OS</span>
                                </div>
                                <div>
                                    <h2 style="margin: 0; font-size: 18px; font-weight: bold;">OSUS REAL ESTATE BROKERAGE LLC</h2>
                                </div>
                            </div>
                            <div style="text-align: right; font-size: 11px;">
                                <div>+971 55 775 6776 | info@osusproperties.com</div>
                                <div>www.osusproperties.com</div>
                                <div>2902 - 2903, Single Tower, Business Bay, Dubai, UAE</div>
                            </div>
                        </div>
                    </div>
                    <!-- QR Code and Vendor Details -->
                    <div style="display: flex; justify-content: space-between; margin-bottom: 20px;">
                        <div style="width: 45%;">
                            <!-- QR Code Section -->
                            <div style="display: flex; align-items: flex-start;">
                                <t t-if="o.qr_in_report == True and o.qr_image">
                                    <div style="width: 120px; height: 120px; border: 1px solid #ddd; display: flex; align-items: center; justify-content: center; margin-right: 15px;">
                                        <img t-att-src="'data:image/png;base64,' + o.qr_image.decode('utf-8')" 
                                             style="max-width: 110px; max-height: 110px; width: auto; height: auto;" 
                                             alt="QR Code"/>
                                    </div>
                                </t>
                                <t t-if="not o.qr_in_report or not o.qr_image">
                                    <div style="width: 120px; height: 120px; border: 1px solid #ddd; display: flex; align-items: center; justify-content: center; background-color: #f8f9fa; margin-right: 15px;">
                                        <span style="color: #6c757d; font-size: 10px;">QR Code</span>
                                    </div>
                                </t>
                                <div style="background: rgba(128, 0, 32, 0.1); padding: 10px; border-radius: 5px;">
                                    <h4 style="margin: 0 0 5px 0; font-size: 14px; color: #800020;">Contact Info</h4>
                                    <div style="font-size: 11px;">Phone: 0563905772</div>
                                    <div style="font-size: 11px;">Email: salescompliance@osusproperties.com</div>
                                </div>
                            </div>
                        </div>
                        <div style="width: 45%; text-align: right;">
                            <h4 style="margin: 0 0 10px 0; font-size: 14px; color: #800020;">VENDOR DETAILS</h4>
                            <div style="font-size: 12px; line-height: 1.4;">
                                <div t-field="o.partner_id.name" style="font-weight: bold;"/>
                                <div t-field="o.partner_id.street"/>
                                <div t-field="o.partner_id.city"/>
                                <div t-field="o.partner_id.country_id.name"/>
                                <div>VAT: <span t-field="o.partner_id.vat"/></div>
                            </div>
                        </div>
                    </div>
                    <!-- Invoice Header -->
                    <h2 style="text-align: center; margin: 20px 0; font-size: 20px; color: #800020;">
                        TAX INVOICE <span t-field="o.name" style="color: #d32f2f;"/>
                    </h2>
                    <!-- Dates -->
                    <div style="display: flex; justify-content: space-between; margin-bottom: 20px; padding: 10px; background-color: #f5f5f5;">
                        <div><strong>Invoice Date:</strong> <span t-out="format_uk_date(o.invoice_date)"/></div>
                        <div><strong>Due Date:</strong> <span t-out="format_uk_date(o.invoice_date_due)"/></div>
                        <div><strong>Booking Date:</strong> <span t-out="format_uk_date(o.booking_date)"/></div>
                    </div>
                    <!-- Line Items Table -->
                    <table style="width: 100%; border-collapse: collapse; margin-bottom: 20px; font-size: 11px;">
                        <thead>
                            <tr style="background-color: #800020; color: white;">
                                <th style="border: 1px solid #ddd; padding: 8px; text-align: left;">BUYER</th>
                                <th style="border: 1px solid #ddd; padding: 8px; text-align: left;">PROJECT</th>
                                <th style="border: 1px solid #ddd; padding: 8px; text-align: left;">UNIT</th>
                                <th style="border: 1px solid #ddd; padding: 8px; text-align: right;">COMMISSION RATE</th>
                                <th style="border: 1px solid #ddd; padding: 8px; text-align: right;">UNIT PRICE</th>
                                <th style="border: 1px solid #ddd; padding: 8px; text-align: center;">VAT</th>
                                <th style="border: 1px solid #ddd; padding: 8px; text-align: right;">VAT AMOUNT</th>
                                <th style="border: 1px solid #ddd; padding: 8px; text-align: right;">AMOUNT</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="border: 1px solid #ddd; padding: 8px;"><span t-field="o.buyer.name"/></td>
                                <td style="border: 1px solid #ddd; padding: 8px;"><span t-field="o.project.name"/></td>
                                <td style="border: 1px solid #ddd; padding: 8px;"><span t-field="o.unit.name"/></td>
                                <td style="border: 1px solid #ddd; padding: 8px; text-align: right;">
                                    <t t-if="o.invoice_line_ids">
                                        <span t-esc="'{:.2f}'.format(o.invoice_line_ids[0].quantity * 100)"/>%
                                    </t>
                                </td>
                                <td style="border: 1px solid #ddd; padding: 8px; text-align: right;">
                                    <t t-if="o.invoice_line_ids">
                                        <span t-esc="'{:,.2f}'.format(o.invoice_line_ids[0].price_unit)"/> AED
                                    </t>
                                </td>
                                <td style="border: 1px solid #ddd; padding: 8px; text-align: center;">5%</td>
                                <td style="border: 1px solid #ddd; padding: 8px; text-align: right;">
                                    <span t-esc="'{:,.2f}'.format(o.amount_tax)"/> AED
                                </td>
                                <td style="border: 1px solid #ddd; padding: 8px; text-align: right;">
                                    <span t-esc="'{:,.2f}'.format(o.amount_total)"/> AED
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <!-- Totals Table -->
                    <div style="display: flex; justify-content: flex-end; margin-bottom: 20px;">
                        <table style="width: 300px; border-collapse: collapse; font-size: 12px;">
                            <tr>
                                <td style="border: 1px solid #ddd; padding: 8px; background-color: #f8f9fa;">Untaxed Amount</td>
                                <td style="border: 1px solid #ddd; padding: 8px; text-align: right; background-color: #f8f9fa;">
                                    <span t-esc="'{:,.2f}'.format(o.amount_untaxed)"/> AED
                                </td>
                            </tr>
                            <tr>
                                <td style="border: 1px solid #ddd; padding: 8px; background-color: #f8f9fa;">Tax</td>
                                <td style="border: 1px solid #ddd; padding: 8px; text-align: right; background-color: #f8f9fa;">
                                    <span t-esc="'{:,.2f}'.format(o.amount_tax)"/> AED
                                </td>
                            </tr>
                            <tr style="background-color: #800020; color: white; font-weight: bold;">
                                <td style="border: 1px solid #ddd; padding: 8px;">Total</td>
                                <td style="border: 1px solid #ddd; padding: 8px; text-align: right;">
                                    <span t-esc="'{:,.2f}'.format(o.amount_total)"/> AED
                                </td>
                            </tr>
                        </table>
                    </div>
                    <!-- Amount in Words -->
                    <div style="margin-bottom: 20px; font-size: 12px;">
                        <strong>Amount in Words (Total):</strong>
                        <span t-field="o.amount_total_words"/>
                    </div>
                    <!-- Payment Instructions -->
                    <div style="margin-bottom: 20px;">
                        <h3 style="color: #800020; font-size: 16px; margin-bottom: 10px;">Payment Instructions</h3>
                        <p style="margin-bottom: 15px; font-size: 12px;">Please pay to this Account Details in Cheque or Bank Transfer</p>
                        <table style="width: 100%; border-collapse: collapse; font-size: 12px;">
                            <tr>
                                <td style="padding: 8px; width: 25%; font-weight: bold; background-color: #f8f9fa;">Bank Name</td>
                                <td style="padding: 8px; border-left: 1px solid #ddd;">ABU DHABI COMMERCIAL BANK (ADCB)</td>
                            </tr>
                            <tr>
                                <td style="padding: 8px; font-weight: bold; background-color: #f8f9fa;">Account Name</td>
                                <td style="padding: 8px; border-left: 1px solid #ddd;">OSUS REAL ESTATE BROKERAGE LLC</td>
                            </tr>
                            <tr>
                                <td style="padding: 8px; font-weight: bold; background-color: #f8f9fa;">Account No.</td>
                                <td style="padding: 8px; border-left: 1px solid #ddd;">14041417820001 - AED</td>
                            </tr>
                            <tr>
                                <td style="padding: 8px; font-weight: bold; background-color: #f8f9fa;">IBAN</td>
                                <td style="padding: 8px; border-left: 1px solid #ddd;">AE35003001404141782000</td>
                            </tr>
                            <tr>
                                <td style="padding: 8px; font-weight: bold; background-color: #f8f9fa;">Branch</td>
                                <td style="padding: 8px; border-left: 1px solid #ddd;">Business Bay</td>
                            </tr>
                        </table>
                        <p style="font-style: italic; margin-top: 10px; font-size: 11px;">Please include your reference number when making the payment</p>
                    </div>
                    <!-- Footer -->
                    <div style="text-align: center; padding: 15px; background-color: #800020; color: white; margin-top: 30px;">
                        <div style="font-size: 11px;">+971 55 775 6776 | info@osusproperties.com</div>
                        <div style="font-size: 11px;">www.osusproperties.com</div>
                        <div style="font-size: 11px;">2902 - 2903, Single Tower, Business Bay, Dubai, UAE</div>
                    </div>
                </div>
            </t>
        </t>
    </template>
</odoo>
