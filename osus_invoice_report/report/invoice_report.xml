<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="report_osus_invoice_document">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="doc">
                <t t-set="o" t-value="doc.with_context(lang=lang)"/>
                <t t-set="format_uk_date" t-value="lambda d: d.strftime('%d/%m/%Y') if d else ''"/>
                <t t-set="format_number" t-value="lambda v: '{:,.2f}'.format(float(v)) if v else '0.00'"/>
                <div class="page" style="background: white; margin: 0; padding: 20px; font-family: Arial, sans-serif;">
                    <!-- Custom CSS to override Odoo defaults -->
                    <style>
                        .page * {
                            background: inherit !important;
                        }
                        .page table {
                            background: white !important;
                        }
                        .page td, .page th {
                            background: inherit !important;
                        }
                        .page tr[style*="background-color: #800020"] td {
                            background-color: #800020 !important;
                        }
                        .page tr[style*="background-color: #f8f9fa"] td {
                            background-color: #f8f9fa !important;
                        }
                    </style>
                    <div style="max-width: 100%; margin: 0 auto; background: white; position: relative; z-index: 1;">
                            <!-- QR Code and Vendor Details -->
                            <div class="row mb-4" style="margin-top: 20px;">
                                <div class="col-6">
                                    <!-- QR Code Section -->
                                    <div style="display: flex; align-items: flex-start;">
                                        <t t-if="o.qr_in_report == True">
                                            <div style="width:120px; height:120px; border: 2px solid #800020; display: flex; align-items: center; justify-content: center; background-color: white;">
                                                <img t-att-src="'data:image/png;base64,' + o.qr_image.decode('utf-8')" 
                                                     style="max-width: 110px; max-height: 110px; width: auto; height: auto;" 
                                                     alt="QR Code" t-if="o.qr_image"/>
                                            </div>
                                        </t>
                                        <t t-if="not o.qr_in_report or not o.qr_image">
                                            <div style="width:120px; height:120px; border: 2px solid #800020; display: flex; align-items: center; justify-content: center; background-color: #f8f9fa;">
                                                <span style="color: #800020; font-weight: bold;">QR Code</span>
                                            </div>
                                        </t>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div style="text-align: right; padding-left: 20px;">
                                        <h5 style="color: #800020; font-weight: bold; font-size: 16px; margin-bottom: 15px; text-decoration: underline;">VENDOR DETAILS</h5>
                                        <div style="color: black; font-size: 14px; line-height: 1.4; margin-bottom: 8px;">
                                            <strong t-field="o.partner_id.name"/>
                                        </div>
                                        <div style="color: black; font-size: 13px; line-height: 1.4; margin-bottom: 5px;" t-field="o.partner_id.street"/>
                                        <t t-if="o.partner_id.street2">
                                            <div style="color: black; font-size: 13px; line-height: 1.4; margin-bottom: 5px;" t-field="o.partner_id.street2"/>
                                        </t>
                                        <div style="color: black; font-size: 13px; line-height: 1.4; margin-bottom: 5px;">
                                            <span t-field="o.partner_id.city"/>
                                            <t t-if="o.partner_id.zip">, <span t-field="o.partner_id.zip"/></t>
                                        </div>
                                        <div style="color: black; font-size: 13px; line-height: 1.4; margin-bottom: 5px;" t-field="o.partner_id.country_id.name"/>
                                        <div style="color: black; font-size: 13px; line-height: 1.4;">
                                            <strong>VAT: <span t-field="o.partner_id.vat"/></strong>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Invoice Header -->
                            <div style="text-align: center; margin: 30px 0;">
                                <h2 style="color: #800020; font-size: 32px; font-weight: bold; margin: 0; letter-spacing: 1px;">
                                    TAX INVOICE <span t-field="o.name" style="color: #800020;"/>
                                </h2>
                            </div>

                            <!-- Dates -->
                            <div class="row mb-4" style="margin-bottom: 25px;">
                                <div class="col-4">
                                    <div style="font-size: 14px;">
                                        <strong style="color: #800020;">Invoice Date:</strong> 
                                        <span style="color: black;" t-out="format_uk_date(o.invoice_date)"/>
                                    </div>
                                </div>
                                <div class="col-4 text-center">
                                    <div style="font-size: 14px;">
                                        <strong style="color: #800020;">Due Date:</strong> 
                                        <span style="color: black;" t-out="format_uk_date(o.invoice_date_due)"/>
                                    </div>
                                </div>
                                <div class="col-4 text-end">
                                    <div style="font-size: 14px;">
                                        <strong style="color: #800020;">Booking Date:</strong> 
                                        <span style="color: black;" t-out="format_uk_date(o.booking_date)"/>
                                    </div>
                                </div>
                            </div>

                            <!-- Line Items -->
                            <table class="table table-bordered mb-4" style="border: 4px solid #800020; border-collapse: collapse; background: white !important;">
                                <thead>
                                    <tr style="background-color: #800020 !important; color: white; font-weight: bold;">
                                        <th style="color: white; padding: 12px; border: 2px solid #800020; font-size: 14px; background-color: #800020 !important;">BUYER</th>
                                        <th style="color: white; padding: 12px; border: 2px solid #800020; font-size: 14px; background-color: #800020 !important;">PROJECT</th>
                                        <th style="color: white; padding: 12px; border: 2px solid #800020; font-size: 14px; background-color: #800020 !important;">UNIT</th>
                                        <th class="text-end" style="color: white; padding: 12px; border: 2px solid #800020; font-size: 14px; background-color: #800020 !important;">COMMISSION RATE</th>
                                        <th class="text-end" style="color: white; padding: 12px; border: 2px solid #800020; font-size: 14px; background-color: #800020 !important;">UNIT PRICE</th>
                                        <th class="text-center" style="color: white; padding: 12px; border: 2px solid #800020; font-size: 14px; background-color: #800020 !important;">VAT</th>
                                        <th class="text-end" style="color: white; padding: 12px; border: 2px solid #800020; font-size: 14px; background-color: #800020 !important;">VAT AMOUNT</th>
                                        <th class="text-end" style="color: white; padding: 12px; border: 2px solid #800020; font-size: 14px; background-color: #800020 !important;">AMOUNT</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr style="background-color: white !important;">
                                        <td style="color: black; padding: 12px; border: 2px solid #800020; font-size: 13px; background-color: white !important;"><span t-field="o.buyer_id.name"/></td>
                                        <td style="color: black; padding: 12px; border: 2px solid #800020; font-size: 13px; background-color: white !important;"><span t-field="o.project_id.name"/></td>
                                        <td style="color: black; padding: 12px; border: 2px solid #800020; font-size: 13px; background-color: white !important;"><span t-field="o.unit_id.name"/></td>
                                        <td class="text-end" style="color: black; padding: 12px; border: 2px solid #800020; font-size: 13px; background-color: white !important;">
                                            <t t-if="o.invoice_line_ids">
                                                <span t-esc="format_number(o.invoice_line_ids[0].quantity * 100)"/>%
                                            </t>
                                            <t t-else="">0.00%</t>
                                        </td>
                                        <td class="text-end" style="color: black; padding: 12px; border: 2px solid #800020; font-size: 13px; background-color: white !important;">
                                            <span t-esc="format_number(o.sale_value)"/> AED
                                        </td>
                                        <td class="text-center" style="color: black; padding: 12px; border: 2px solid #800020; font-size: 13px; background-color: white !important;">5%</td>
                                        <td class="text-end" style="color: black; padding: 12px; border: 2px solid #800020; font-size: 13px; background-color: white !important;">
                                            <span t-esc="format_number(o.amount_tax)"/> AED
                                        </td>
                                        <td class="text-end" style="color: black; padding: 12px; border: 2px solid #800020; font-size: 13px; background-color: white !important;">
                                            <span t-esc="format_number(o.amount_total)"/> AED
                                        </td>
                                    </tr>
                                </tbody>
                            </table>

                            <!-- Totals - All rows with burgundy background -->
                            <div class="row justify-content-end" style="margin-bottom: 20px;">
                                <div class="col-5">
                                    <table style="width: 100%; border-collapse: collapse; border: 4px solid #800020; background: white !important;">
                                        <tr style="background-color: #800020 !important; color: white; font-weight: bold;">
                                            <td style="border: 2px solid #800020; padding: 12px; font-size: 14px; background-color: #800020 !important; color: white;">Untaxed Amount</td>
                                            <td style="border: 2px solid #800020; padding: 12px; text-align: right; font-size: 14px; background-color: #800020 !important; color: white;">
                                                <span t-esc="format_number(o.amount_untaxed)"/> AED
                                            </td>
                                        </tr>
                                        <tr style="background-color: #800020 !important; color: white; font-weight: bold;">
                                            <td style="border: 2px solid #800020; padding: 12px; font-size: 14px; background-color: #800020 !important; color: white;">Tax</td>
                                            <td style="border: 2px solid #800020; padding: 12px; text-align: right; font-size: 14px; background-color: #800020 !important; color: white;">
                                                <span t-esc="format_number(o.amount_tax)"/> AED
                                            </td>
                                        </tr>
                                        <tr style="background-color: #800020 !important; color: white; font-weight: bold;">
                                            <td style="border: 2px solid #800020; padding: 12px; font-size: 14px; background-color: #800020 !important; color: white;">Total Due Amount</td>
                                            <td style="border: 2px solid #800020; padding: 12px; text-align: right; font-size: 14px; background-color: #800020 !important; color: white;">
                                                <span t-esc="format_number(o.amount_total)"/> AED
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                            </div>

                            <!-- Amount in Words -->
                            <div class="mb-4" style="color: black; font-size: 14px; margin-bottom: 25px;">
                                <strong style="color: #800020;">Amount in Words (Total):</strong>
                                <span t-field="o.amount_total_words" style="font-style: italic;"/>
                            </div>

                            <!-- Payment Instructions -->
                            <div class="mb-4" style="margin-bottom: 25px;">
                                <h4 style="color: #800020; font-size: 18px; font-weight: bold; margin-bottom: 15px;">Payment Instructions</h4>
                                <p style="color: black; font-size: 14px; margin-bottom: 15px;">Please pay to this Account Details in Cheque or Bank Transfer</p>
                                <table style="width: 100%; border-collapse: collapse; border: 3px solid #800020; background: white !important;">
                                    <tr style="background-color: #f8f9fa !important;">
                                        <td style="width: 30%; color: black; font-weight: bold; padding: 10px; border: 2px solid #800020; font-size: 13px; background-color: #f8f9fa !important;">Bank Name</td>
                                        <td style="color: black; padding: 10px; border: 2px solid #800020; font-size: 13px; background-color: #f8f9fa !important;">ABU DHABI COMMERCIAL BANK (ADCB)</td>
                                    </tr>
                                    <tr style="background-color: white !important;">
                                        <td style="color: black; font-weight: bold; padding: 10px; border: 2px solid #800020; font-size: 13px; background-color: white !important;">Account Name</td>
                                        <td style="color: black; padding: 10px; border: 2px solid #800020; font-size: 13px; background-color: white !important;">OSUS REAL ESTATE BROKERAGE LLC</td>
                                    </tr>
                                    <tr style="background-color: #f8f9fa !important;">
                                        <td style="color: black; font-weight: bold; padding: 10px; border: 2px solid #800020; font-size: 13px; background-color: #f8f9fa !important;">Account No.</td>
                                        <td style="color: black; padding: 10px; border: 2px solid #800020; font-size: 13px; background-color: #f8f9fa !important;">14041417820001 - AED</td>
                                    </tr>
                                    <tr style="background-color: white !important;">
                                        <td style="color: black; font-weight: bold; padding: 10px; border: 2px solid #800020; font-size: 13px; background-color: white !important;">IBAN</td>
                                        <td style="color: black; padding: 10px; border: 2px solid #800020; font-size: 13px; background-color: white !important;">AE35003001404141782000</td>
                                    </tr>
                                    <tr style="background-color: #f8f9fa !important;">
                                        <td style="color: black; font-weight: bold; padding: 10px; border: 2px solid #800020; font-size: 13px; background-color: #f8f9fa !important;">Branch</td>
                                        <td style="color: black; padding: 10px; border: 2px solid #800020; font-size: 13px; background-color: #f8f9fa !important;">Business Bay</td>
                                    </tr>
                                </table>
                                <p class="fst-italic" style="color: black; margin-top: 12px; font-size: 13px; font-style: italic;">Please include your reference number when making the payment</p>
                            </div>

                            <!-- Footer with larger disclaimer -->
                            <div class="text-center" style="color: black; font-size: 13px; margin-top: 20px; border-top: 1px solid #eee; padding-top: 10px; font-weight: bold;">
                                This is a computer generated document. No signature or stamp required.
                            </div>
                        </div>
                    </div>
            </t>
        </t>
    </template>
</odoo>
