<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <!-- Report Actions -->
        <record id="report_customer_invoice" model="ir.actions.report">
            <field name="name">Customer Invoice/Payment Receipt</field>
            <field name="model">sale.order</field>
            <field name="report_type">qweb-pdf</field>
            <field name="report_name">order_status_override.customer_invoice_report_template</field>
            <field name="report_file">order_status_override.customer_invoice_report_template</field>
            <field name="print_report_name">'Customer Invoice - %s' % object.name</field>
            <field name="paperformat_id" ref="base.paperformat_us"/>
        </record>

        <record id="report_commission_payout" model="ir.actions.report">
            <field name="name">Commission Payout Report</field>
            <field name="model">sale.order</field>
            <field name="report_type">qweb-pdf</field>
            <field name="report_name">order_status_override.commission_payout_report_template</field>
            <field name="report_file">order_status_override.commission_payout_report_template</field>
            <field name="print_report_name">'Commission Report - %s' % object.name</field>
            <field name="paperformat_id" ref="base.paperformat_us"/>
        </record>

        <record id="report_comprehensive" model="ir.actions.report">
            <field name="name">Comprehensive Order Report</field>
            <field name="model">sale.order</field>
            <field name="report_type">qweb-pdf</field>
            <field name="report_name">order_status_override.comprehensive_report_template</field>
            <field name="report_file">order_status_override.comprehensive_report_template</field>
            <field name="print_report_name">'Comprehensive Report - %s' % object.name</field>
            <field name="paperformat_id" ref="base.paperformat_us"/>
        </record>

        <!-- Enhanced Commission Report Template -->
        <template id="commission_payout_report_template">
            <t t-name="order_status_override.commission_report_document">
                <t t-call="web.html_container">
                    <t t-foreach="docs" t-as="o">
                        <t t-call="web.external_layout">
                            <div class="page">
                                <style>
                                    @page {
                                        margin: 5mm;
                                        size: A4;
                                    }
                                    
                                    .commission-container {
                                        font-family: Arial, sans-serif;
                                        background: white;
                                        font-size: 12px;
                                        line-height: 1.4;
                                        margin: 0;
                                        padding: 0;
                                    }
                                    
                                    .commission-header {
                                        background: linear-gradient(135deg, #6B2B47, #8B1538);
                                        color: white;
                                        padding: 12px;
                                        margin: 0 0 15px 0;
                                        box-shadow: 0 3px 6px rgba(0,0,0,0.2);
                                    }
                                    
                                    .report-title {
                                        text-align: center;
                                        font-size: 24px;
                                        font-weight: bold;
                                        letter-spacing: 2px;
                                        margin: 0;
                                        text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
                                        text-transform: uppercase;
                                    }
                                    
                                    .report-subtitle {
                                        text-align: center;
                                        font-size: 14px;
                                        margin: 4px 0;
                                        opacity: 0.9;
                                    }
                                    
                                    .section-header {
                                        background: linear-gradient(135deg, #b19024, #8B6F00);
                                        color: white;
                                        padding: 8px 12px;
                                        margin: 15px 0 10px 0;
                                        font-size: 14px;
                                        font-weight: bold;
                                        text-transform: uppercase;
                                        letter-spacing: 1px;
                                        border-radius: 4px;
                                    }
                                    
                                    .info-section {
                                        margin-bottom: 12px;
                                    }
                                    
                                    .info-label {
                                        color: #6b0632;
                                        font-weight: bold;
                                        font-size: 11px;
                                        margin-bottom: 3px;
                                        text-transform: uppercase;
                                        letter-spacing: 0.5px;
                                    }
                                    
                                    .info-value {
                                        border-bottom: 1px solid #333;
                                        padding: 4px;
                                        margin-bottom: 6px;
                                        min-height: 16px;
                                        color: #000;
                                        font-weight: 500;
                                        font-size: 12px;
                                        background: linear-gradient(to bottom, transparent 90%, #f8f9fa 90%);
                                    }
                                    
                                    .commission-table {
                                        width: 100%;
                                        border-collapse: collapse;
                                        margin: 10px 0;
                                        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
                                        font-size: 11px;
                                    }
                                    
                                    .commission-table th {
                                        background: linear-gradient(135deg, #6b0632, #8B1538);
                                        color: white;
                                        padding: 10px 8px;
                                        border: 1px solid #5a0529;
                                        text-align: left;
                                        font-weight: bold;
                                        text-transform: uppercase;
                                        letter-spacing: 0.5px;
                                        font-size: 10px;
                                    }
                                    
                                    .commission-table td {
                                        padding: 8px;
                                        border: 1px solid #ddd;
                                        background: white;
                                        font-size: 11px;
                                    }
                                    
                                    .commission-table tr:nth-child(even) td {
                                        background: #f8f9fa;
                                    }
                                    
                                    .total-section {
                                        background: linear-gradient(135deg, #b19024, #8B6F00);
                                        color: white;
                                        padding: 12px;
                                        text-align: center;
                                        margin: 15px 0;
                                        font-size: 16px;
                                        font-weight: bold;
                                        box-shadow: 0 3px 6px rgba(0, 0, 0, 0.3);
                                        border-radius: 5px;
                                    }
                                    
                                    .summary-grid {
                                        display: grid;
                                        grid-template-columns: 1fr 1fr;
                                        gap: 15px;
                                        margin: 15px 0;
                                    }
                                    
                                    .summary-box {
                                        border: 2px solid #6b0632;
                                        padding: 12px;
                                        background: linear-gradient(135deg, #f8f9fa, #e9ecef);
                                        border-radius: 6px;
                                    }
                                    
                                    .summary-title {
                                        color: #6b0632;
                                        font-weight: bold;
                                        font-size: 13px;
                                        margin-bottom: 8px;
                                        text-transform: uppercase;
                                        letter-spacing: 0.5px;
                                        text-align: center;
                                    }
                                    
                                    .summary-item {
                                        display: flex;
                                        justify-content: space-between;
                                        margin-bottom: 4px;
                                        font-size: 11px;
                                        padding: 2px 0;
                                        border-bottom: 1px dotted #ccc;
                                    }
                                    
                                    .summary-total {
                                        display: flex;
                                        justify-content: space-between;
                                        margin-top: 8px;
                                        font-size: 12px;
                                        font-weight: bold;
                                        padding: 6px;
                                        background: white;
                                        border-radius: 3px;
                                        border: 1px solid #6b0632;
                                    }
                                    
                                    .qr-code-container {
                                        text-align: center;
                                        padding: 8px;
                                    }
                                    
                                    .qr-code-box {
                                        background: white;
                                        padding: 6px;
                                        border-radius: 4px;
                                        display: inline-block;
                                        border: 2px solid #333;
                                    }
                                    
                                    .footer-note {
                                        background: linear-gradient(135deg, #6B2B47, #8B1538);
                                        color: white;
                                        text-align: center;
                                        padding: 10px;
                                        font-size: 11px;
                                        margin: 15px 0 0 0;
                                    }
                                    
                                    .creator-info {
                                        font-size: 10px;
                                        color: #666;
                                        margin-top: 5px;
                                        text-align: right;
                                    }
                                    
                                    .highlight-amount {
                                        color: #b19024;
                                        font-weight: bold;
                                    }
                                    
                                    .text-center { text-align: center; }
                                    .text-right { text-align: right; }
                                    .font-bold { font-weight: bold; }
                                    
                                    @media print {
                                        .page {
                                            margin: 0;
                                            padding: 2px;
                                        }
                                        .commission-container {
                                            margin: 0;
                                            padding: 0;
                                        }
                                    }
                                </style>

                                <div class="commission-container">
                                    <!-- Header Section -->
                                    <div class="commission-header">
                                        <div class="row">
                                            <div class="col-2">
                                                <div class="qr-code-container">
                                                    <div class="qr-code-box">
                                                        <t t-if="o.qr_code">
                                                            <img t-att-src="'data:image/png;base64,' + o.qr_code.decode('utf-8')" style="width: 65px; height: 65px;"/>
                                                        </t>
                                                        <t t-else="">
                                                            <div style="width: 65px; height: 65px; background: white; border: 1px solid #333; position: relative;">
                                                                <div style="position: absolute; top: 2px; left: 2px; width: 15px; height: 15px; background: #000;"></div>
                                                                <div style="position: absolute; top: 2px; right: 2px; width: 15px; height: 15px; background: #000;"></div>
                                                                <div style="position: absolute; bottom: 2px; left: 2px; width: 15px; height: 15px; background: #000;"></div>
                                                                <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 12px; height: 12px; background: #000;"></div>
                                                            </div>
                                                        </t>
                                                    </div>
                                                    <div style="font-size: 8px; margin-top: 2px; color: white;">Commission</div>
                                                </div>
                                            </div>
                                            <div class="col-8">
                                                <h1 class="report-title">Commission Report</h1>
                                                <div class="report-subtitle">
                                                    <strong>Order: <span t-field="o.name"/>
 | Date: <span t-field="o.booking_date"/>
                                                </strong>
                                            </div>
                                        </div>
                                        <div class="col-2">
                                            <div style="text-align: right; font-size: 12px;">
                                                <div>Business Bay, Dubai</div>
                                                <div>+971-4-366-4500</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </tr>
                        </table>
                    </div>
                </div>

                <!-- Order Lines -->
                <div class="row">
                    <div class="col-12">
                        <table class="table table-striped" style="border: 1px solid #1f4788;">
                            <thead style="background-color: #1f4788; color: white;">
                                <tr>
                                    <th>Product/Service</th>
                                    <th class="text-center">Qty</th>
                                    <th class="text-right">Unit Price</th>
                                    <th class="text-right">Subtotal</th>
                                </tr>
                            </thead>
                            <tbody>
                                <t t-foreach="doc.order_line" t-as="line">
                                    <tr>
                                        <td>
                                            <strong>
                                                <span t-field="line.product_id.name"/>
                                            </strong>
                                            <t t-if="line.name != line.product_id.name">
                                                <br/>
                                                <small t-field="line.name"/>
                                            </t>
                                        </td>
                                        <td class="text-center">
                                            <span t-field="line.product_uom_qty"/>
                                        </td>
                                        <td class="text-right">
                                            <span t-field="line.price_unit" t-options='{"widget": "monetary", "display_currency": doc.currency_id}'/>
                                        </td>
                                        <td class="text-right">
                                            <span t-field="line.price_subtotal" t-options='{"widget": "monetary", "display_currency": doc.currency_id}'/>
                                        </td>
                                    </tr>
                                </t>
                            </tbody>
                            <tfoot style="background-color: #f8f9fa;">
                                <tr>
                                    <td colspan="3" class="text-right">
                                        <strong>Subtotal:</strong>
                                    </td>
                                    <td class="text-right">
                                        <strong>
                                            <span t-field="doc.amount_untaxed" t-options='{"widget": "monetary", "display_currency": doc.currency_id}'/>
                                        </strong>
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="3" class="text-right">
                                        <strong>Taxes:</strong>
                                    </td>
                                    <td class="text-right">
                                        <strong>
                                            <span t-field="doc.amount_tax" t-options='{"widget": "monetary", "display_currency": doc.currency_id}'/>
                                        </strong>
                                    </td>
                                </tr>
                                <tr style="background-color: #1f4788; color: white;">
                                    <td colspan="3" class="text-right">
                                        <strong>Total:</strong>
                                    </td>
                                    <td class="text-right">
                                        <strong>
                                            <span t-field="doc.amount_total" t-options='{"widget": "monetary", "display_currency": doc.currency_id}'/>
                                        </strong>
                                    </td>
                                </tr>
                            </tfoot>
                        </table>
                    </div>
                </div>

                <!-- Commission Information -->
                <t t-if="doc.total_commission_amount and doc.total_commission_amount > 0">
                    <div class="row mt32">
                        <div class="col-12">
                            <div style="background-color: #fff3cd; border: 1px solid #ffeaa7; padding: 15px; border-radius: 5px;">
                                <strong>Commission Information:</strong>
                                <br/>
                                            Total Commission Amount: <strong>
                                <span t-field="doc.total_commission_amount" t-options='{"widget": "monetary", "display_currency": doc.currency_id}' style="color: #856404;"/>
                            </strong>
                        </div>
                    </div>
                </div>
            </t>

            <div class="oe_structure"/>
        </div>
    </t>
</t>
</t>
</template>

<template id="commission_payout_report_template">
<t t-call="web.html_container">
<t t-foreach="docs" t-as="doc">
    <t t-call="web.external_layout">
        <div class="page">
            <div class="oe_structure"/>

            <!-- Header -->
            <div class="row">
                <div class="col-8">
                    <h2 style="color: #ff6900;">Commission Payout Report</h2>
                    <h4>
                        <span t-field="doc.name"/>
                    </h4>
                </div>
                <div class="col-4 text-right">
                    <strong>Order Date:</strong>
                    <span t-field="doc.date_order" t-options='{"format": "MMMM d, Y"}'/>
                </div>
            </div>

            <hr style="border-color: #ff6900;"/>

            <!-- Order Summary -->
            <div class="row mt32 mb32">
                <div class="col-6">
                    <div style="background-color: #fff5f0; padding: 15px; border-left: 4px solid #ff6900;">
                        <strong>Customer:</strong>
                        <span t-field="doc.partner_id.name"/>
                        <br/>
                        <strong>Order Total:</strong>
                        <span t-field="doc.amount_total" t-options='{"widget": "monetary", "display_currency": doc.currency_id}'/>
                        <br/>
                        <t t-if="doc.custom_status_id">
                            <strong>Current Status:</strong>
                            <span t-field="doc.custom_status_id.name"/>
                        </t>
                    </div>
                </div>
                <div class="col-6">
                    <div style="background-color: #e8f4f8; padding: 15px; border-left: 4px solid #17a2b8;">
                        <strong>Total Commission:</strong>
                        <span t-field="doc.total_commission_amount" t-options='{"widget": "monetary", "display_currency": doc.currency_id}' style="color: #17a2b8; font-size: 1.3em; font-weight: bold;"/>
                        <br/>
                        <strong>Net Revenue:</strong>
                        <span t-esc="doc.amount_total - doc.total_commission_amount" t-options='{"widget": "monetary", "display_currency": doc.currency_id}'/>
                    </div>
                </div>
            </div>

            <!-- Commission Breakdown -->
            <div class="row">
                <div class="col-6">
                    <h4 style="color: #ff6900;">Internal Commissions</h4>
                    <t t-if="doc.internal_commission_ids">
                        <table class="table table-striped" style="border: 1px solid #ff6900;">
                            <thead style="background-color: #ff6900; color: white;">
                                <tr>
                                    <th>User</th>
                                    <th class="text-right">Amount</th>
                                </tr>
                            </thead>
                            <tbody>
                                <t t-foreach="doc.internal_commission_ids" t-as="comm">
                                    <tr>
                                        <td>
                                            <span t-field="comm.user_id.name"/>
                                        </td>
                                        <td class="text-right">
                                            <strong>
                                                <span t-field="comm.amount_fixed" t-options='{"widget": "monetary", "display_currency": doc.currency_id}'/>
                                            </strong>
                                        </td>
                                    </tr>
                                </t>
                            </tbody>
                        </table>
                    </t>
                    <t t-if="not doc.internal_commission_ids">
                        <div style="padding: 20px; background-color: #f8f9fa; text-align: center; color: #6c757d;">
                                            No internal commissions configured
                        </div>
                    </t>
                </div>

                <div class="col-6">
                    <h4 style="color: #ff6900;">External Commissions</h4>
                    <t t-if="doc.external_commission_ids">
                        <table class="table table-striped" style="border: 1px solid #ff6900;">
                            <thead style="background-color: #ff6900; color: white;">
                                <tr>
                                    <th>Partner</th>
                                    <th class="text-right">Amount</th>
                                </tr>
                            </thead>
                            <tbody>
                                <t t-foreach="doc.external_commission_ids" t-as="comm">
                                    <tr>
                                        <td>
                                            <span t-field="comm.partner_id.name"/>
                                        </td>
                                        <td class="text-right">
                                            <strong>
                                                <span t-field="comm.amount_fixed" t-options='{"widget": "monetary", "display_currency": doc.currency_id}'/>
                                            </strong>
                                        </td>
                                    </tr>
                                </t>
                            </tbody>
                        </table>
                    </t>
                    <t t-if="not doc.external_commission_ids">
                        <div style="padding: 20px; background-color: #f8f9fa; text-align: center; color: #6c757d;">
                                            No external commissions configured
                        </div>
                    </t>
                </div>
            </div>

            <div class="oe_structure"/>
        </div>
    </t>
</t>
</t>
</template>

<template id="comprehensive_report_template">
<t t-call="web.html_container">
<t t-foreach="docs" t-as="doc">
    <t t-call="web.external_layout">
        <div class="page">
            <div class="oe_structure"/>

            <!-- Header -->
            <div class="row">
                <div class="col-8">
                    <h2 style="color: #6c757d;">Comprehensive Order Report</h2>
                    <h3>
                        <span t-field="doc.name"/>
                    </h3>
                </div>
                <div class="col-4 text-right">
                    <strong>Order Date:</strong>
                    <span t-field="doc.date_order" t-options='{"format": "MMMM d, Y"}'/>
                </div>
            </div>

            <hr/>

            <!-- Order Overview -->
            <div class="row mt32 mb32">
                <div class="col-4">
                    <div style="background-color: #e8f4f8; padding: 15px; border-left: 4px solid #17a2b8; height: 100%;">
                        <h5 style="color: #17a2b8;">Order Information</h5>
                        <strong>Customer:</strong>
                        <span t-field="doc.partner_id.name"/>
                        <br/>
                        <strong>Order Date:</strong>
                        <span t-field="doc.date_order" t-options='{"format": "MMMM d, Y"}'/>
                        <br/>
                        <t t-if="doc.custom_status_id">
                            <strong>Current Status:</strong>
                            <br/>
                            <span t-field="doc.custom_status_id.name" style="background-color: #17a2b8; color: white; padding: 4px 8px; border-radius: 4px; font-weight: bold;"/>
                        </t>
                    </div>
                </div>
                <div class="col-4">
                    <div style="background-color: #fff3cd; padding: 15px; border-left: 4px solid #856404; height: 100%;">
                        <h5 style="color: #856404;">Financial Summary</h5>
                        <strong>Order Total:</strong>
                        <br/>
                        <span t-field="doc.amount_total" t-options='{"widget": "monetary", "display_currency": doc.currency_id}' style="font-size: 1.2em; color: #856404;"/>
                        <br/>
                        <strong>Commission:</strong>
                        <br/>
                        <span t-field="doc.total_commission_amount" t-options='{"widget": "monetary", "display_currency": doc.currency_id}'/>
                    </div>
                </div>
                <div class="col-4">
                    <div style="background-color: #f8d7da; padding: 15px; border-left: 4px solid #dc3545; height: 100%;">
                        <h5 style="color: #dc3545;">Payment Summary</h5>
                        <strong>Total Payment Out:</strong>
                        <br/>
                        <span t-field="doc.total_payment_out" t-options='{"widget": "monetary", "display_currency": doc.currency_id}' style="color: #dc3545;"/>
                        <br/>
                        <strong>Net Profit:</strong>
                        <br/>
                        <span t-esc="doc.amount_total - doc.total_payment_out" t-options='{"widget": "monetary", "display_currency": doc.currency_id}' style="font-weight: bold;"/>
                    </div>
                </div>
            </div>

            <!-- Status History -->
            <t t-if="doc.custom_status_history_ids">
                <div class="row mt32">
                    <div class="col-12">
                        <h4>Status History</h4>
                        <table class="table table-sm table-striped">
                            <thead style="background-color: #f8f9fa;">
                                <tr>
                                    <th>Date/Time</th>
                                    <th>Status</th>
                                    <th>Changed By</th>
                                    <th>Notes</th>
                                </tr>
                            </thead>
                            <tbody>
                                <t t-foreach="doc.custom_status_history_ids.sorted('create_date')" t-as="history">
                                    <tr>
                                        <td>
                                            <span t-field="history.create_date" t-options='{"format": "MMMM d, Y HH:mm"}'/>
                                        </td>
                                        <td>
                                            <span t-field="history.status_id.name"/>
                                        </td>
                                        <td>
                                            <span t-field="history.create_uid.name"/>
                                        </td>
                                        <td>
                                            <span t-field="history.notes"/>
                                        </td>
                                    </tr>
                                </t>
                            </tbody>
                        </table>
                    </div>
                </div>
            </t>

            <div class="oe_structure"/>
        </div>
    </t>
</t>
</t>
</template>
</data>
</odoo>
