<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <!-- Report Actions -->
        <record id="report_customer_invoice" model="ir.actions.report">
            <field name="name">Customer Invoice/Payment Receipt</field>
            <field name="model">sale.order</field>
            <field name="report_type">qweb-pdf</field>
            <field name="report_name">order_status_override.customer_invoice_report_template</field>
            <field name="report_file">order_status_override.customer_invoice_report_template</field>
            <field name="print_report_name">'Customer Invoice - %s' % object.name</field>
            <field name="paperformat_id" ref="base.paperformat_us"/>
        </record>

        <record id="report_commission_payout" model="ir.actions.report">
            <field name="name">Commission Payout Report</field>
            <field name="model">sale.order</field>
            <field name="report_type">qweb-pdf</field>
            <field name="report_name">order_status_override.commission_payout_report_template</field>
            <field name="report_file">order_status_override.commission_payout_report_template</field>
            <field name="print_report_name">'Commission Report - %s' % object.name</field>
            <field name="paperformat_id" ref="base.paperformat_us"/>
        </record>

        <!-- Commission Report Template -->
        <template id="commission_payout_report_template">
            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="o">
                    <t t-call="web.external_layout">
                        <div class="page">
                            <style>
                                @page {
                                    margin: 5mm;
                                    size: A4;
                                }
                                
                                .commission-container {
                                    font-family: Arial, sans-serif;
                                    background: white;
                                    font-size: 12px;
                                    line-height: 1.4;
                                    color: #333;
                                }
                                
                                .gradient-header {
                                    background: linear-gradient(135deg, #b19024 0%, #d4af37 100%);
                                    color: white;
                                    padding: 15px;
                                    margin: -5mm -5mm 10px -5mm;
                                    border-radius: 0;
                                }
                                
                                .company-logo {
                                    width: 120px;
                                    height: auto;
                                    background: rgba(255,255,255,0.9);
                                    padding: 8px;
                                    border-radius: 5px;
                                }
                                
                                .header-title {
                                    font-size: 24px;
                                    font-weight: bold;
                                    margin: 0;
                                    text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
                                }
                                
                                .header-subtitle {
                                    font-size: 14px;
                                    margin: 5px 0 0 0;
                                    opacity: 0.9;
                                }
                                
                                .info-grid {
                                    display: grid;
                                    grid-template-columns: 1fr 1fr;
                                    gap: 20px;
                                    margin: 15px 0;
                                }
                                
                                .info-card {
                                    background: #f8f9fa;
                                    border: 1px solid #e9ecef;
                                    border-radius: 5px;
                                    padding: 12px;
                                }
                                
                                .info-title {
                                    color: #b19024;
                                    font-weight: bold;
                                    font-size: 13px;
                                    margin-bottom: 8px;
                                    border-bottom: 1px solid #b19024;
                                    padding-bottom: 3px;
                                }
                                
                                .commission-grid {
                                    display: grid;
                                    grid-template-columns: 1fr 1fr;
                                    gap: 15px;
                                    margin: 15px 0;
                                }
                                
                                .commission-section {
                                    background: #ffffff;
                                    border: 1px solid #d4af37;
                                    border-radius: 5px;
                                    overflow: hidden;
                                }
                                
                                .section-header {
                                    background: linear-gradient(90deg, #b19024, #d4af37);
                                    color: white;
                                    padding: 8px 12px;
                                    font-weight: bold;
                                    font-size: 13px;
                                }
                                
                                .commission-table {
                                    width: 100%;
                                    border-collapse: collapse;
                                }
                                
                                .commission-table td {
                                    padding: 6px 12px;
                                    border-bottom: 1px solid #f0f0f0;
                                    font-size: 11px;
                                }
                                
                                .commission-table td:first-child {
                                    font-weight: 500;
                                    color: #555;
                                }
                                
                                .commission-table td:last-child {
                                    text-align: right;
                                    font-weight: bold;
                                    color: #b19024;
                                }
                                
                                .total-row {
                                    background: #f8f9fa;
                                    border-top: 2px solid #b19024 !important;
                                }
                                
                                .grand-total {
                                    background: linear-gradient(90deg, #b19024, #d4af37);
                                    color: white;
                                    margin: 15px 0;
                                    padding: 12px;
                                    border-radius: 5px;
                                    text-align: center;
                                    font-size: 16px;
                                    font-weight: bold;
                                }
                                
                                .qr-section {
                                    text-align: center;
                                    margin: 15px 0;
                                    padding: 10px;
                                    background: #f8f9fa;
                                    border-radius: 5px;
                                }
                                
                                .footer-note {
                                    margin-top: 20px;
                                    padding: 10px;
                                    background: #fff3e0;
                                    border-left: 4px solid #d4af37;
                                    font-size: 10px;
                                    color: #666;
                                }
                                
                                @media print {
                                    body, html {
                                        margin: 0;
                                        padding: 0;
                                    }
                                }
                            </style>

                            <div class="commission-container">
                                <!-- Header Section -->
                                <div class="gradient-header">
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <div>
                                            <h1 class="header-title">COMMISSION REPORT</h1>
                                            <p class="header-subtitle">Professional Real Estate Commission Statement</p>
                                        </div>
                                        <div style="text-align: center;">
                                            <!-- QR Code with enhanced styling -->
                                            <div style="width: 60px; height: 60px; background: white; display: inline-block; border-radius: 5px; padding: 5px; position: relative;">
                                                <div style="position: absolute; top: 2px; left: 2px; width: 15px; height: 15px; background: #000;"></div>
                                                <div style="position: absolute; top: 2px; right: 2px; width: 15px; height: 15px; background: #000;"></div>
                                                <div style="position: absolute; bottom: 2px; left: 2px; width: 15px; height: 15px; background: #000;"></div>
                                                <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 12px; height: 12px; background: #000;"></div>
                                            </div>
                                            <div style="font-size: 8px; margin-top: 2px; color: white;">Commission</div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Order Information Grid -->
                                <div class="info-grid">
                                    <div class="info-card">
                                        <div class="info-title">ORDER DETAILS</div>
                                        <div>
                                            <strong>Order #:</strong>
                                            <span t-field="o.name"/>
                                        </div>
                                        <div>
                                            <strong>Date:</strong>
                                            <span t-field="o.date_order" t-options='{"format": "MMMM d, Y"}'/>
                                        </div>
                                        <div>
                                            <strong>Status:</strong>
                                            <span t-field="o.custom_status_id.name"/>
                                        </div>
                                        <div>
                                            <strong>Total Amount:</strong>
                                            <span t-field="o.amount_total" t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
                                        </div>
                                    </div>

                                    <div class="info-card">
                                        <div class="info-title">CLIENT INFORMATION</div>
                                        <div>
                                            <strong>Client:</strong>
                                            <span t-field="o.partner_id.name"/>
                                        </div>
                                        <div>
                                            <strong>Email:</strong>
                                            <span t-field="o.partner_id.email"/>
                                        </div>
                                        <div>
                                            <strong>Phone:</strong>
                                            <span t-field="o.partner_id.phone"/>
                                        </div>
                                        <t t-if="o.project_id">
                                            <div>
                                                <strong>Project:</strong>
                                                <span t-field="o.project_id.name"/>
                                            </div>
                                        </t>
                                    </div>
                                </div>

                                <!-- Commission Breakdown Grid -->
                                <div class="commission-grid">
                                    <!-- External Commissions -->
                                    <div class="commission-section">
                                        <div class="section-header">EXTERNAL COMMISSIONS</div>
                                        <table class="commission-table">
                                            <t t-if="o.broker_partner_id">
                                                <tr>
                                                    <td>Broker Commission<br/>
                                                    <small t-field="o.broker_partner_id.name"/>
                                                </td>
                                                <td>
                                                    <span t-field="o.broker_amount" t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
                                                </td>
                                            </tr>
                                        </t>
                                        <t t-if="o.referrer_partner_id">
                                            <tr>
                                                <td>Referrer Commission<br/>
                                                <small t-field="o.referrer_partner_id.name"/>
                                            </td>
                                            <td>
                                                <span t-field="o.referrer_amount" t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
                                            </td>
                                        </tr>
                                    </t>
                                    <t t-if="o.cashback_partner_id">
                                        <tr>
                                            <td>Cashback<br/>
                                            <small t-field="o.cashback_partner_id.name"/>
                                        </td>
                                        <td>
                                            <span t-field="o.cashback_amount" t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
                                        </td>
                                    </tr>
                                </t>
                                <tr class="total-row">
                                    <td>
                                        <strong>External Total</strong>
                                    </td>
                                    <td>
                                        <strong>
                                            <span t-field="o.total_external_commission_amount" t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
                                        </strong>
                                    </td>
                                </tr>
                            </table>
                        </div>

                        <!-- Internal Commissions -->
                        <div class="commission-section">
                            <div class="section-header">INTERNAL COMMISSIONS</div>
                            <table class="commission-table">
                                <t t-if="o.agent1_partner_id">
                                    <tr>
                                        <td>Agent 1 Commission<br/>
                                        <small t-field="o.agent1_partner_id.name"/>
                                    </td>
                                    <td>
                                        <span t-field="o.agent1_amount" t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
                                    </td>
                                </tr>
                            </t>
                            <t t-if="o.agent2_partner_id">
                                <tr>
                                    <td>Agent 2 Commission<br/>
                                    <small t-field="o.agent2_partner_id.name"/>
                                </td>
                                <td>
                                    <span t-field="o.agent2_amount" t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
                                </td>
                            </tr>
                        </t>
                        <t t-if="o.manager_partner_id">
                            <tr>
                                <td>Manager Commission<br/>
                                <small t-field="o.manager_partner_id.name"/>
                            </td>
                            <td>
                                <span t-field="o.manager_amount" t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
                            </td>
                        </tr>
                    </t>
                    <t t-if="o.director_partner_id">
                        <tr>
                            <td>Director Commission<br/>
                            <small t-field="o.director_partner_id.name"/>
                        </td>
                        <td>
                            <span t-field="o.director_amount" t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
                        </td>
                    </tr>
                </t>
                <tr class="total-row">
                    <td>
                        <strong>Internal Total</strong>
                    </td>
                    <td>
                        <strong>
                            <span t-field="o.total_internal_commission_amount" t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
                        </strong>
                    </td>
                </tr>
            </table>
        </div>
    </div>

    <!-- Grand Total -->
    <div class="grand-total">
                                    TOTAL COMMISSION AMOUNT: <span t-field="o.total_commission_amount" t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
    </div>

    <!-- Footer Notes -->
    <div class="footer-note">
        <strong>IMPORTANT NOTES:</strong>
        <br/>
                                    • This commission report is generated automatically based on the sales order configuration.<br/>
                                    • Please verify all commission amounts before processing payments.<br/>
                                    • For inquiries, contact the finance department.<br/>
                                                                        • Generated on <span t-esc="datetime.datetime.now().strftime('%B %d, %Y at %I:%M %p')"/>
</div>
</div>

<div class="oe_structure"/>
</div>
</t>
</t>
</t>
</template>

</data>
</odoo>
