<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Minimal Working Payment Form View -->
    <record id="view_account_payment_form_enhanced" model="ir.ui.view">
        <field name="name">account.payment.form.enhanced</field>
        <field name="model">account.payment</field>
        <field name="inherit_id" ref="account.view_account_payment_form"/>
        <field name="arch" type="xml">
            <!-- Add voucher_state status bar -->
            <xpath expr="//field[@name='state']" position="after">
                <field name="voucher_state" widget="statusbar" statusbar_visible="draft,submitted,under_review,approved,authorized,posted"/>
            </xpath>

            <!-- Add minimal approval workflow buttons -->
            <xpath expr="//header" position="inside">
                <!-- Submit for Approval -->
                <button name="action_submit_for_approval" string="Submit for Approval" type="object" class="btn-primary" invisible="voucher_state != 'draft'"/>

                <!-- Review -->
                <button name="action_review" string="Review" type="object" class="btn-info" invisible="voucher_state != 'submitted'"/>

                <!-- Approve -->
                <button name="action_approve" string="Approve" type="object" class="btn-success" invisible="voucher_state != 'under_review'"/>

                <!-- Authorize -->
                <button name="action_authorize" string="Authorize" type="object" class="btn-success" invisible="voucher_state not in ('approved', 'under_review')"/>

                <!-- Reject -->
                <button name="action_reject" string="Reject" type="object" class="btn-danger" invisible="voucher_state not in ('submitted', 'under_review', 'approved')"/>

                <!-- Reset to Draft -->
                <button name="action_reset_to_draft" string="Reset to Draft" type="object" class="btn-secondary" invisible="voucher_state != 'rejected'"/>
            </xpath>

            <!-- Add voucher information after amount field -->
            <xpath expr="//field[@name='amount']" position="after">
                <field name="voucher_number" readonly="1"/>
                <field name="voucher_type" readonly="1"/>
            </xpath>

            <!-- Add approval information tab -->
            <xpath expr="//notebook" position="inside">
                <page string="Approval Information">
                    <group>
                        <group string="Workflow Status">
                            <field name="reviewer_id" readonly="1"/>
                            <field name="approver_id" readonly="1"/>
                            <field name="authorizer_id" readonly="1"/>
                        </group>
                        <group string="Workflow Dates">
                            <field name="submitted_date" readonly="1"/>
                            <field name="reviewed_date" readonly="1"/>
                            <field name="approved_date" readonly="1"/>
                            <field name="authorized_date" readonly="1"/>
                        </group>
                    </group>
                </page>
            </xpath>
        </field>
    </record>

    <!-- Minimal Payment List View -->
    <record id="view_account_payment_tree_enhanced" model="ir.ui.view">
        <field name="name">account.payment.tree.enhanced</field>
        <field name="model">account.payment</field>
        <field name="inherit_id" ref="account.view_account_payment_tree"/>
        <field name="arch" type="xml">
            <!-- Add voucher fields to tree view -->
            <xpath expr="//field[@name='name']" position="after">
                <field name="voucher_number" optional="show"/>
                <field name="voucher_type" optional="hide"/>
            </xpath>

            <!-- Add approval fields -->
            <xpath expr="//field[@name='state']" position="after">
                <field name="voucher_state" optional="show"/>
            </xpath>
        </field>
    </record>

    <!-- Minimal Search view enhancements -->
    <record id="view_account_payment_search_enhanced" model="ir.ui.view">
        <field name="name">account.payment.search.enhanced</field>
        <field name="model">account.payment</field>
        <field name="inherit_id" ref="account.view_account_payment_search"/>
        <field name="arch" type="xml">
            <!-- Add approval-related filters -->
            <xpath expr="//filter[@name='state_posted']" position="after">
                <separator/>
                <filter name="voucher_state_submitted" string="Submitted" domain="[('voucher_state', '=', 'submitted')]"/>
                <filter name="voucher_state_approved" string="Approved" domain="[('voucher_state', '=', 'approved')]"/>
                <filter name="voucher_state_authorized" string="Authorized" domain="[('voucher_state', '=', 'authorized')]"/>
            </xpath>

            <!-- Add search fields -->
            <xpath expr="//field[@name='name']" position="after">
                <field name="voucher_number"/>
            </xpath>
        </field>
    </record>
</odoo>