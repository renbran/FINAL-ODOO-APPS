// Payment Approval Module - Main Entry Point
// Enterprise-level SCSS orchestration for the OSUS Properties payment approval system

// ===== IMPORTS =====
@import "variables";
@import "components/dashboard";
@import "components/badges";
@import "components/signature";
@import "components/qr_code";
@import "components/account_move_widgets";

// ===== GLOBAL OVERRIDES =====

// Form view enhancements
.o_form_view {
    .o_payment_approval_form {
        .o_form_sheet {
            max-width: none;

            .o_group {
                .o_field_widget {
                    &.o_field_monetary {
                        .o_input {
                            font-weight: $font-weight-semibold;
                            font-size: $font-size-large;
                            color: $osus-primary;
                        }
                    }

                    &.o_field_selection {
                        .o_input {
                            &[data-value="draft"] {
                                color: $state-draft;
                            }
                            &[data-value="submitted"] {
                                color: $state-submitted;
                            }
                            &[data-value="under_review"] {
                                color: $state-under-review;
                            }
                            &[data-value="approved"] {
                                color: $state-approved;
                            }
                            &[data-value="authorized"] {
                                color: $state-authorized;
                            }
                            &[data-value="posted"] {
                                color: $state-posted;
                            }
                            &[data-value="rejected"] {
                                color: $state-rejected;
                            }
                            &[data-value="cancelled"] {
                                color: $state-cancelled;
                            }
                        }
                    }
                }
            }
        }

        .o_form_statusbar {
            .o_statusbar_status {
                .o_arrow_button {
                    &.btn-secondary {
                        background-color: $state-draft;
                        border-color: $state-draft;
                    }

                    &.btn-primary {
                        background-color: $osus-primary;
                        border-color: $osus-primary;
                    }

                    &[data-value="submitted"] {
                        background-color: $state-submitted;
                        border-color: $state-submitted;
                    }

                    &[data-value="under_review"] {
                        background-color: $state-under-review;
                        border-color: $state-under-review;
                        color: $osus-dark;
                    }

                    &[data-value="approved"] {
                        background-color: $state-approved;
                        border-color: $state-approved;
                    }

                    &[data-value="authorized"] {
                        background-color: $state-authorized;
                        border-color: $state-authorized;
                    }

                    &[data-value="posted"] {
                        background-color: $state-posted;
                        border-color: $state-posted;
                    }

                    &[data-value="rejected"] {
                        background-color: $state-rejected;
                        border-color: $state-rejected;
                    }
                }
            }
        }
    }
}

// List view enhancements
.o_list_view {
    .o_payment_approval_list {
        .o_data_row {
            transition: $transition-fast;

            &:hover {
                background-color: rgba($osus-primary, 0.02);
            }

            &.o_row_urgent {
                background-color: rgba($urgency-urgent, 0.05);
                border-left: 4px solid $urgency-urgent;

                &:hover {
                    background-color: rgba($urgency-urgent, 0.1);
                }
            }

            &.o_row_overdue {
                background-color: rgba($osus-warning, 0.05);
                border-left: 4px solid $osus-warning;

                &:hover {
                    background-color: rgba($osus-warning, 0.1);
                }
            }

            .o_data_cell {
                &.o_approval_state_cell {
                    .o_field_widget {
                        @extend .o_approval_badge;

                        &[data-value="draft"] {
                            @extend .state-draft;
                        }
                        &[data-value="submitted"] {
                            @extend .state-submitted;
                        }
                        &[data-value="under_review"] {
                            @extend .state-under-review;
                        }
                        &[data-value="approved"] {
                            @extend .state-approved;
                        }
                        &[data-value="authorized"] {
                            @extend .state-authorized;
                        }
                        &[data-value="posted"] {
                            @extend .state-posted;
                        }
                        &[data-value="rejected"] {
                            @extend .state-rejected;
                        }
                        &[data-value="cancelled"] {
                            @extend .state-cancelled;
                        }
                    }
                }

                &.o_approval_amount_cell {
                    .o_field_widget {
                        font-weight: $font-weight-semibold;
                        color: $osus-primary;
                    }
                }

                &.o_urgency_cell {
                    .o_field_widget {
                        @extend .o_urgency_badge;

                        &[data-value="low"] {
                            @extend .urgency-low;
                        }
                        &[data-value="normal"] {
                            @extend .urgency-normal;
                        }
                        &[data-value="high"] {
                            @extend .urgency-high;
                        }
                        &[data-value="urgent"] {
                            @extend .urgency-urgent;
                        }
                    }
                }

                &.o_approval_tier_cell {
                    .o_field_widget {
                        @extend .o_approval_tier;

                        &[data-value="1"] {
                            @extend .tier-1;
                        }
                        &[data-value="2"] {
                            @extend .tier-2;
                        }
                        &[data-value="3"] {
                            @extend .tier-3;
                        }
                        &[data-value="4"] {
                            @extend .tier-4;
                        }
                        &[data-value="5"] {
                            @extend .tier-5;
                        }
                        &[data-value="6"] {
                            @extend .tier-6;
                        }
                    }
                }
            }
        }
    }
}

// Kanban view enhancements
.o_kanban_view {
    .o_payment_approval_kanban {
        .o_kanban_record {
            border-radius: $border-radius-lg;
            box-shadow: $box-shadow-sm;
            transition: $transition-base;

            &:hover {
                transform: translateY(-2px);
                box-shadow: $box-shadow;
            }

            .o_kanban_content {
                .o_kanban_primary_left {
                    .o_payment_name {
                        font-weight: $font-weight-semibold;
                        color: $osus-primary;
                        margin-bottom: $spacer-sm;
                    }

                    .o_payment_partner {
                        color: #6c757d;
                        font-size: $font-size-small;
                        margin-bottom: $spacer-xs;
                    }

                    .o_payment_amount {
                        font-size: $font-size-large;
                        font-weight: $font-weight-bold;
                        color: $osus-dark;
                    }
                }

                .o_kanban_primary_right {
                    .o_kanban_tags {
                        .o_tag {
                            border-radius: $border-radius-pill;
                            font-size: $font-size-small;
                            font-weight: $font-weight-medium;
                        }
                    }
                }
            }

            .o_kanban_footer {
                .o_kanban_footer_left {
                    .o_field_widget {
                        &.o_priority_star {
                            color: $osus-warning;
                        }
                    }
                }
            }
        }
    }
}

// Activity view enhancements
.o_activity_view {
    .o_payment_approval_activity {
        .o_activity_record {
            .o_activity_summary {
                .o_activity_title {
                    color: $osus-primary;
                    font-weight: $font-weight-semibold;
                }
            }
        }
    }
}

// Calendar view enhancements
.o_calendar_view {
    .o_payment_approval_calendar {
        .fc-event {
            border-radius: $border-radius;
            font-size: $font-size-small;

            &.state-draft {
                background-color: $state-draft;
            }
            &.state-submitted {
                background-color: $state-submitted;
            }
            &.state-under-review {
                background-color: $state-under-review;
            }
            &.state-approved {
                background-color: $state-approved;
            }
            &.state-authorized {
                background-color: $state-authorized;
            }
            &.state-posted {
                background-color: $state-posted;
            }
            &.state-rejected {
                background-color: $state-rejected;
            }
            &.state-cancelled {
                background-color: $state-cancelled;
            }
        }
    }
}

// Modal and wizard styling
.modal {
    .o_payment_approval_wizard {
        .modal-header {
            background: linear-gradient(135deg, $osus-primary 0%, lighten($osus-primary, 10%) 100%);
            color: #ffffff;
            border-bottom: none;

            .modal-title {
                font-weight: $font-weight-semibold;
            }

            .btn-close {
                filter: invert(1);
            }
        }

        .modal-body {
            padding: $spacer-xl;

            .wizard-step {
                margin-bottom: $spacer-xl;

                .step-header {
                    display: flex;
                    align-items: center;
                    margin-bottom: $spacer-lg;

                    .step-number {
                        width: 32px;
                        height: 32px;
                        border-radius: 50%;
                        background: $osus-primary;
                        color: #ffffff;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        font-weight: $font-weight-semibold;
                        margin-right: $spacer-md;
                    }

                    .step-title {
                        font-size: $font-size-large;
                        font-weight: $font-weight-semibold;
                        color: $osus-dark;
                        margin: 0;
                    }
                }

                .step-content {
                    margin-left: 48px;
                }
            }
        }

        .modal-footer {
            border-top: 1px solid $border-color-light;
            padding: $spacer-lg $spacer-xl;

            .btn {
                padding: $spacer-sm $spacer-lg;
                font-weight: $font-weight-medium;

                &.btn-primary {
                    @include button-variant($osus-primary, $osus-primary, #ffffff);
                }

                &.btn-secondary {
                    @include button-variant(#ffffff, $border-color, $osus-dark);
                }
            }
        }
    }
}

// Notification styling
.o_notification {
    &.payment_approval_notification {
        border-radius: $border-radius;
        box-shadow: $box-shadow;

        &.type_success {
            border-left: 4px solid $state-approved;
        }

        &.type_warning {
            border-left: 4px solid $osus-warning;
        }

        &.type_danger {
            border-left: 4px solid $state-rejected;
        }

        &.type_info {
            border-left: 4px solid $osus-info;
        }
    }
}

// Print styles
@media print {
    .o_payment_approval_form,
    .o_payment_approval_dashboard {
        .no-print {
            display: none !important;
        }

        .o_form_statusbar,
        .o_form_button_box,
        .o_attachment_preview {
            display: none !important;
        }

        .o_form_sheet {
            box-shadow: none !important;
            border: 1px solid $border-color !important;
        }

        .o_approval_header {
            background: #ffffff !important;
            color: $osus-dark !important;
            border: 2px solid $osus-primary !important;

            * {
                color: $osus-dark !important;
            }
        }

        .o_digital_signature_widget,
        .o_qr_code_widget {
            page-break-inside: avoid;

            .signature-controls,
            .qr-actions {
                display: none !important;
            }
        }
    }
}

// Accessibility enhancements
@media (prefers-reduced-motion: reduce) {
    * {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
    }
}

// High contrast mode support
@media (prefers-contrast: high) {
    .o_approval_badge,
    .o_urgency_badge,
    .o_approval_tier {
        border-width: 2px;
        font-weight: $font-weight-bold;
    }

    .o_payment_approval_dashboard {
        .stat-card {
            border: 2px solid $border-color;
        }
    }
}
